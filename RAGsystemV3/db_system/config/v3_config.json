{
  "version": "3.0.0",
  "system": {
    "mode": "auto",
    "log_level": "WARNING"
  },
  "paths": {
    "input_pdf_dir": "./document/orig_pdf",
    "mineru_output_dir": "./document/md",
    "final_image_dir": "./central/vector_db/images",
    "vector_db_dir": "./central/vector_db",
    "temp_dir": "./temp",
    "logs_dir": "../logs",
    "config_backups_dir": "./config/backups",
    "config_versions_dir": "./config/versions"
  },
  "document_processing": {
    "chunk_size": 1000,
    "chunk_overlap": 200
  },
  "vectorization": {
    "text_embedding_model": "text-embedding-v1",
    "image_embedding_model": "multimodal-embedding-one-peace-v1"
  },
  "image_processing": {
    "enable_enhancement": true,
    "enhancement_model": "qwen-vl-plus",
    "enhancement_model_api": "dashscope"
  },
  "mineru": {
    "api_endpoint": "https://mineru.net",
    "batch_size": 10,
    "timeout": 300,
    "retry_count": 3,
    "poll_interval": 10
  },
  "api_rate_limiting": {
    "enhancement_batch_size": 5,
    "enhancement_delay_seconds": 2,
    "vectorization_batch_size": 10,
    "vectorization_delay_seconds": 1,
    "max_retries": 3,
    "retry_delay_seconds": 5,
    "enable_rate_limiting": true
  },
  "batch_processing": {
    "enhancement_workers": 2,
    "vectorization_workers": 3,
    "queue_size": 100,
    "timeout_seconds": 300,
    "progress_report_interval": 10
  },
  "failure_handling": {
    "skip_failed_images": true,
    "max_retries": 3,
    "retry_delay_seconds": 5,
    "continue_on_failure": true,
    "generate_failure_report": true,
    "failure_report_path": "../logs/failure_report.json",
    "mark_for_later_processing": true,
    "failure_report_format": "detailed"
  },
  "storage": {
    "backup_enabled": true,
    "backup_interval": 24
  },
  "rag_system": {
    "enabled": true,
    "version": "3.0.0",
    "models": {
      "llm": {
        "model_name": "qwen-turbo-latest",
        "max_tokens": 2048,
        "temperature": 0.7,
        "system_prompt": "你是一个专业的AI助手，能够基于提供的上下文信息生成准确、相关、完整的答案。"
      },
      "reranking": {
        "model_name": "gte-rerank-v2",
        "batch_size": 32,
        "similarity_threshold": 0.7
      }
    },
    "query_processing": {
      "max_context_length": 4000,
      "max_results": 10,
      "relevance_threshold": 0.5,
      "cache_enabled": true,
      "cache_ttl": 3600
    },
    "table_merge": {
      "enabled": true,
      "max_subtables_per_group": 10,
      "merge_timeout": 5.0,
      "fallback_to_original": true,
      "log_merge_details": false
    },
    "engines": {
      "text_engine": {
        "enabled": true,
        "max_results": 20,
        "similarity_threshold": 0.4
      },
      "image_engine": {
        "enabled": true,
        "max_results": 20,
        "similarity_threshold": 0.2
      },
      "table_engine": {
        "enabled": true,
        "max_results": 10,
        "similarity_threshold": 0.3,
        "structure_search_threshold": 0.2,
        "keyword_search_threshold": 0.2,
        "expansion_search_threshold": 0.2
      },
      "hybrid_engine": {
        "enabled": true,
        "max_results": 25,
        "weights": {
          "image": 0.3,
          "text": 0.4,
          "table": 0.3
        }
      }
    },
    "performance": {
      "max_concurrent_queries": 10,
      "query_timeout": 60,
      "enable_monitoring": true
    },
    "prompt_templates": {
      "general_qa": "基于以下上下文信息回答问题：\n\n上下文：{context}\n\n问题：{question}",
      "table_qa": "基于以下表格信息回答问题：\n\n表格内容：{context}\n\n问题：{question}",
      "image_qa": "基于以下图像信息回答问题：\n\n图像描述：{context}\n\n问题：{question}"
    },
    "preset_questions": {
      "enabled": true,
      "config_file": "./config/preset_questions.json",
      "default_confidence": 0.9,
      "default_question_type": "static",
      "max_questions_per_type": 5
    },
    "memory_module": {
      "enabled": true,
      "database_path": "rag_memory1.db",
      "compression": {
        "enabled": true,
        "threshold": 20,
        "strategy": "semantic",
        "max_compression_ratio": 0.3
      },
      "retrieval": {
        "similarity_threshold": 0.7,
        "max_results": 5,
        "time_decay_factor": 0.1,
        "keyword_threshold": 0.1,
        "semantic_threshold": 0.1,
        "time_window_hours": 24,
        "enable_jieba": true,
        "enable_tfidf": true
      },
      "session": {
        "max_sessions_per_user": 100,
        "session_timeout": 3600,
        "auto_cleanup": true
      },
      "vectorization": {
        "model": "text-embedding-v1",
        "dimensions": 1536,
        "chunk_type": "memory"
      },
      "query_rewrite": {
        "enabled": true,
        "spacy_model": "zh_core_web_sm",
        "fallback_model": "en_core_web_sm",
        "similarity_threshold": 0.3,
        "pronoun_patterns": [
          "它", "他", "她", "这", "那", "这家", "那家", 
          "这个", "那个", "这张", "那张", "这张图", "那张图"
        ],
        "entity_types": {
          "ORG": "机构名",
          "PERSON": "人名", 
          "PRODUCT": "产品名",
          "WORK_OF_ART": "作品名（如图表）",
          "GPE": "地名",
          "MISC": "其他"
        },
        "entity_priority": ["WORK_OF_ART", "ORG", "PERSON", "PRODUCT", "GPE", "MISC"],
        "max_entities": 10
      },
      "context_integration": {
        "enabled": true,
        "max_memories_in_prompt": 5,
        "memory_weight": 0.3,
        "include_memory_metadata": true,
        "memory_format": "conversation",
        "memory_section_title": "历史对话",
        "min_relevance_score": 0.1,
        "max_memory_length": 1000
      }
    }
  }
}