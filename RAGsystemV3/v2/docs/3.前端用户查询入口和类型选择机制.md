
## ğŸ“± **å‰ç«¯ç”¨æˆ·æŸ¥è¯¢å…¥å£å’Œç±»å‹é€‰æ‹©æœºåˆ¶ - ä¿®æ­£ç‰ˆ**

### ğŸ¯1. **å·¦ä¾§è¾¹æ æŸ¥è¯¢ç±»å‹é€‰æ‹©**

å‰ç«¯æä¾›äº†5ä¸ªä¸»è¦çš„æŸ¥è¯¢ç±»å‹å…¥å£ï¼Œæ¯ä¸ªéƒ½æœ‰ç‹¬ç«‹çš„é¢„è®¾é—®é¢˜åŒºåŸŸï¼š

```html
<!-- é¢„è®¾é—®é¢˜åŒºåŸŸ -->
<div class="preset-section" data-type="smart">
    <h3 onclick="togglePresetSection(this)">ğŸ¤– æ™ºèƒ½æŸ¥è¯¢</h3>
    <div class="preset-questions" id="smart-questions"></div>
</div>

<div class="preset-section" data-type="image">
    <h3 onclick="togglePresetSection(this)">ğŸ–¼ï¸ å›¾ç‰‡æŸ¥è¯¢</h3>
    <div class="preset-questions" id="image-questions"></div>
</div>

<div class="preset-section" data-type="text">
    <h3 onclick="togglePresetSection(this)">ğŸ“ æ–‡æœ¬æŸ¥è¯¢</h3>
    <div class="preset-questions" id="text-questions"></div>
</div>

<div class="preset-section" data-type="table">
    <h3 onclick="togglePresetSection(this)">ğŸ“Š è¡¨æ ¼æŸ¥è¯¢</h3>
    <div class="preset-questions" id="table-questions"></div>
</div>

<div class="preset-section" data-type="hybrid">
    <h3 onclick="togglePresetSection(this)">ğŸ”€ æ··åˆæŸ¥è¯¢</h3>
    <div class="preset-questions" id="hybrid-questions"></div>
</div>
```

### ğŸ”„2.**æŸ¥è¯¢ç±»å‹åˆ‡æ¢æœºåˆ¶**

#### **2.1 æ‰‹åŠ¨åˆ‡æ¢**
ç”¨æˆ·ç‚¹å‡»å·¦ä¾§è¾¹æ çš„æŸ¥è¯¢ç±»å‹æ ‡é¢˜ï¼Œç³»ç»Ÿä¼šï¼š
- å…³é—­å…¶ä»–æŸ¥è¯¢ç±»å‹åŒºåŸŸ
- æ¿€æ´»å½“å‰é€‰æ‹©çš„æŸ¥è¯¢ç±»å‹
- æ˜¾ç¤ºå¯¹åº”çš„é¢„è®¾é—®é¢˜
- æ›´æ–°å³ä¸Šè§’çš„æŸ¥è¯¢ç±»å‹æŒ‡ç¤ºå™¨

```javascript
function togglePresetSection(header) {
    const section = header.parentElement;
    const isActive = section.classList.contains('active');
    const queryType = section.getAttribute('data-type');
    
    // å…³é—­å…¶ä»–åŒºåŸŸ
    document.querySelectorAll('.preset-section').forEach(s => {
        s.classList.remove('active');
    });
    
    // åˆ‡æ¢å½“å‰åŒºåŸŸ
    if (!isActive) {
        section.classList.add('active');
        
        // æ˜¾ç¤ºæŸ¥è¯¢ç±»å‹åˆ‡æ¢çŠ¶æ€
        const typeNames = {
            'text': 'æ–‡æœ¬æŸ¥è¯¢',
            'image': 'å›¾ç‰‡æŸ¥è¯¢', 
            'table': 'è¡¨æ ¼æŸ¥è¯¢',
            'hybrid': 'æ··åˆæŸ¥è¯¢',
            'smart': 'æ™ºèƒ½æŸ¥è¯¢'
        };
        showStatus(`å·²åˆ‡æ¢åˆ°${typeNames[queryType] || queryType}æ¨¡å¼`, 'info');
    }
}
```

#### **2.2 è‡ªåŠ¨æ¿€æ´»**
å½“ç”¨æˆ·ç‚¹å‡»é¢„è®¾é—®é¢˜æ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æ¿€æ´»å¯¹åº”çš„æŸ¥è¯¢ç±»å‹ï¼š

```javascript
questionDiv.onclick = () => {
    // è®¾ç½®é—®é¢˜æ–‡æœ¬
    document.getElementById('user-input').value = question;
    document.getElementById('user-input').focus();
    
    // è‡ªåŠ¨æ¿€æ´»å¯¹åº”çš„æŸ¥è¯¢ç±»å‹
    activateQueryType(type);
    
    // æ˜¾ç¤ºçŠ¶æ€æç¤º
    showStatus(`å·²åˆ‡æ¢åˆ°${typeNames[type] || type}æ¨¡å¼`, 'info');
};
```

### ğŸ“š3. **é¢„è®¾é—®é¢˜åŠ è½½æœºåˆ¶**

ç³»ç»Ÿä¼šä¸ºæ¯ç§æŸ¥è¯¢ç±»å‹åŠ è½½å¯¹åº”çš„é¢„è®¾é—®é¢˜ï¼š

```javascript
async function loadPresetQuestions() {
    try {
        // åˆ†åˆ«åŠ è½½å„ç±»é¢„è®¾é—®é¢˜
        const types = ['image', 'text', 'table', 'hybrid'];
        
        for (const type of types) {
            const response = await fetch(`/api/v2/qa/preset-questions?type=${type}`);
            if (!response.ok) {
                throw new Error(`HTTP ${response.status}`);
            }
            
            const data = await response.json();
            
            // å¡«å……å¯¹åº”ç±»å‹çš„é¢„è®¾é—®é¢˜
            fillPresetQuestions(type, data.questions || []);
        }
        
        // æ·»åŠ æ™ºèƒ½æŸ¥è¯¢çš„é¢„è®¾é—®é¢˜ï¼ˆç¡¬ç¼–ç ï¼Œå› ä¸ºä¸éœ€è¦ä»APIåŠ è½½ï¼‰
        const smartQuestions = [
            "è¯·åˆ†æä¸­èŠ¯å›½é™…çš„æ•´ä½“æƒ…å†µ",
            "ä¸­èŠ¯å›½é™…æœ‰å“ªäº›å…³é”®ä¼˜åŠ¿ï¼Ÿ",
            "è¯·æ€»ç»“ä¸­èŠ¯å›½é™…çš„å‘å±•å‰æ™¯",
            "ä¸­èŠ¯å›½é™…é¢ä¸´å“ªäº›æŒ‘æˆ˜ï¼Ÿ",
            "è¯·ç»¼åˆåˆ†æä¸­èŠ¯å›½é™…çš„è´¢åŠ¡çŠ¶å†µ"
        ];
        fillPresetQuestions('smart', smartQuestions);
        
    } catch (error) {
        console.error('åŠ è½½é¢„è®¾é—®é¢˜å¤±è´¥:', error);
        showStatus('åŠ è½½é¢„è®¾é—®é¢˜å¤±è´¥', 'error');
    }
}
```

### ğŸš€4. **æŸ¥è¯¢è¯·æ±‚å‘é€æœºåˆ¶**

#### **4.1 æŸ¥è¯¢ç±»å‹æ£€æµ‹**
åœ¨å‘é€æŸ¥è¯¢æ—¶ï¼Œç³»ç»Ÿä¼šæ£€æµ‹å½“å‰æ¿€æ´»çš„æŸ¥è¯¢ç±»å‹ï¼š

```javascript
async function sendMessage() {
    // æ£€æµ‹å½“å‰é€‰æ‹©çš„æŸ¥è¯¢ç±»å‹
    let queryType = 'hybrid'; // é»˜è®¤å€¼
    
    // æ£€æŸ¥å“ªä¸ªæŸ¥è¯¢ç±»å‹è¢«é€‰ä¸­
    const textSection = document.querySelector('.preset-section[data-type="text"]');
    const imageSection = document.querySelector('.preset-section[data-type="image"]');
    const tableSection = document.querySelector('.preset-section[data-type="table"]');
    const hybridSection = document.querySelector('.preset-section[data-type="hybrid"]');
    const smartSection = document.querySelector('.preset-section[data-type="smart"]');
    
    if (textSection && textSection.classList.contains('active')) {
        queryType = 'text';
        console.log('æ£€æµ‹åˆ°æ–‡æœ¬æŸ¥è¯¢æ¨¡å¼');
    } else if (imageSection && imageSection.classList.contains('active')) {
        queryType = 'image';
        console.log('æ£€æµ‹åˆ°å›¾ç‰‡æŸ¥è¯¢æ¨¡å¼');
    } else if (tableSection && tableSection.classList.contains('active')) {
        queryType = 'table';
        console.log('æ£€æµ‹åˆ°è¡¨æ ¼æŸ¥è¯¢æ¨¡å¼');
    } else if (hybridSection && hybridSection.classList.contains('active')) {
        queryType = 'hybrid';
        console.log('æ£€æµ‹åˆ°æ··åˆæŸ¥è¯¢æ¨¡å¼');
    } else if (smartSection && smartSection.classList.contains('active')) {
        queryType = 'smart';
        console.log('æ£€æµ‹åˆ°æ™ºèƒ½æŸ¥è¯¢æ¨¡å¼');
    } else {
        // å¦‚æœæ²¡æœ‰æ˜ç¡®é€‰æ‹©ï¼Œé»˜è®¤ä½¿ç”¨æ··åˆæŸ¥è¯¢
        queryType = 'hybrid';
        console.log('æœªæ£€æµ‹åˆ°æ˜ç¡®çš„æŸ¥è¯¢ç±»å‹ï¼Œä½¿ç”¨é»˜è®¤æ··åˆæŸ¥è¯¢æ¨¡å¼');
    }
```

#### **4.2 è¯·æ±‚å‚æ•°ä¼ é€’**
ç³»ç»Ÿä¼šå°†æ£€æµ‹åˆ°çš„æŸ¥è¯¢ç±»å‹ä½œä¸ºå‚æ•°ä¼ é€’ç»™åç«¯ï¼š

```javascript
// ä½¿ç”¨ç»Ÿä¸€çš„æŸ¥è¯¢æ¥å£ï¼ŒåŒ…æ‹¬æ™ºèƒ½æŸ¥è¯¢
const response = await fetch('/api/v2/qa/ask', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json'
    },
    body: JSON.stringify({
        question: message,
        session_id: currentSessionId,
        query_type: queryType  // å¯ä»¥æ˜¯ 'smart', 'image', 'text', 'table', 'hybrid'
    })
});
```

### ğŸ“±5. **ç”¨æˆ·ç•Œé¢åé¦ˆæœºåˆ¶**

#### **5.1 æŸ¥è¯¢ç±»å‹æŒ‡ç¤ºå™¨**
å³ä¸Šè§’æ˜¾ç¤ºå½“å‰æŸ¥è¯¢æ¨¡å¼ï¼š

```html
<div class="query-type-indicator" id="query-type-indicator" style="display: none;">
    å½“å‰æ¨¡å¼: æ··åˆæŸ¥è¯¢
</div>
```

#### **5.2 çŠ¶æ€æç¤º**
ç³»ç»Ÿä¼šæ˜¾ç¤ºæŸ¥è¯¢ç±»å‹åˆ‡æ¢çš„çŠ¶æ€æç¤ºï¼š

```javascript
function updateQueryTypeIndicator(type) {
    const indicator = document.getElementById('query-type-indicator');
    if (indicator) {
        const typeNames = {
            'text': 'æ–‡æœ¬æŸ¥è¯¢',
            'image': 'å›¾ç‰‡æŸ¥è¯¢', 
            'table': 'è¡¨æ ¼æŸ¥è¯¢',
            'hybrid': 'æ··åˆæŸ¥è¯¢',
            'smart': 'æ™ºèƒ½æŸ¥è¯¢'
        };
        
        indicator.textContent = `å½“å‰æ¨¡å¼: ${typeNames[type] || type}`;
        indicator.style.display = 'block';
        
        // 3ç§’åè‡ªåŠ¨éšè—
        setTimeout(() => {
            indicator.style.display = 'none';
        }, 3000);
    }
}
```

### ğŸ”„6. **å®Œæ•´æµç¨‹æ€»ç»“**

```
ç”¨æˆ·æ“ä½œ â†’ æŸ¥è¯¢ç±»å‹é€‰æ‹© â†’ é¢„è®¾é—®é¢˜å±•ç¤º â†’ é—®é¢˜è¾“å…¥ â†’ æŸ¥è¯¢ç±»å‹æ£€æµ‹ â†’ è¯·æ±‚å‘é€ â†’ åç«¯å¤„ç†
    â†“              â†“              â†“           â†“          â†“           â†“          â†“
ç‚¹å‡»ä¾§è¾¹æ  â†’ æ¿€æ´»å¯¹åº”ç±»å‹ â†’ æ˜¾ç¤ºé¢„è®¾é—®é¢˜ â†’ è¾“å…¥é—®é¢˜ â†’ æ£€æµ‹å½“å‰ç±»å‹ â†’ ä¼ é€’query_type â†’ åç«¯æ™ºèƒ½å¤„ç†
```

### 7.**è®¾è®¡ä¼˜åŠ¿**

1. **ç›´è§‚æ€§**ï¼šç”¨æˆ·å¯ä»¥é€šè¿‡å›¾æ ‡å’Œæ ‡é¢˜æ¸…æ¥šçŸ¥é“æ¯ç§æŸ¥è¯¢ç±»å‹çš„ç”¨é€”
2. **çµæ´»æ€§**ï¼šæ”¯æŒæ‰‹åŠ¨åˆ‡æ¢å’Œè‡ªåŠ¨æ¿€æ´»ä¸¤ç§æ–¹å¼
3. **ä¸€è‡´æ€§**ï¼šæ¯ç§ç±»å‹éƒ½æœ‰å¯¹åº”çš„é¢„è®¾é—®é¢˜ï¼Œé™ä½ç”¨æˆ·å­¦ä¹ æˆæœ¬
4. **åé¦ˆæ€§**ï¼šå®æ—¶æ˜¾ç¤ºå½“å‰æŸ¥è¯¢æ¨¡å¼ï¼Œé¿å…ç”¨æˆ·å›°æƒ‘
5. **å®¹é”™æ€§**ï¼šå¦‚æœæ²¡æœ‰æ˜ç¡®é€‰æ‹©ï¼Œé»˜è®¤ä½¿ç”¨æ··åˆæŸ¥è¯¢æ¨¡å¼
6. **æ™ºèƒ½åŒ–**ï¼šæ™ºèƒ½æŸ¥è¯¢ç±»å‹èƒ½å¤Ÿè‡ªåŠ¨åˆ¤æ–­æœ€ä½³æŸ¥è¯¢æ–¹å¼

### 8.**å½“å‰å®ç°çŠ¶æ€**

- âœ… **å·²å®ç°å¹¶æ­£å¸¸å·¥ä½œ**ï¼šå›¾ç‰‡æŸ¥è¯¢ã€æ–‡æœ¬æŸ¥è¯¢ã€è¡¨æ ¼æŸ¥è¯¢ã€æ··åˆæŸ¥è¯¢ã€æ™ºèƒ½æŸ¥è¯¢
- ğŸ”§ **æŠ€æœ¯çŠ¶æ€**ï¼šæ··åˆæŸ¥è¯¢åŠŸèƒ½å·²ä¿®å¤å¹¶æµ‹è¯•éªŒè¯é€šè¿‡ï¼Œæ™ºèƒ½æŸ¥è¯¢åŠŸèƒ½å·²å®Œå…¨å®ç°å¹¶æµ‹è¯•é€šè¿‡

---

