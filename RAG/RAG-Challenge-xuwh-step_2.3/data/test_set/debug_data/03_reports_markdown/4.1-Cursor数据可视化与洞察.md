# Cursor数据可视化与洞察

# 今天的学习目标

# Cursor数据可视化与洞察

Python基础语法与AI   
·机器学习七步法 CASE：客户续保预测   
数据可视化   
模型洞察

Python基础语法与AI

# Python是数据分析的首选语言

# Thinking: 如何选择数据分析语言？

<html><body><table><tr><td colspan="5">Worldwide, Jun 2020 compared to a year ago:</td></tr><tr><td>Rank</td><td>Change</td><td>Language</td><td> Share</td><td> Trend </td></tr><tr><td>1</td><td></td><td>Python</td><td>31.6 %</td><td>+4.3 %</td></tr><tr><td>2</td><td></td><td> Java</td><td>17.67 %</td><td>-2.4 %</td></tr><tr><td>3</td><td></td><td>Javascript</td><td>8.02 %</td><td>-0.2 %</td></tr><tr><td>4</td><td></td><td>C#</td><td>6.87 %</td><td>-0.4 %</td></tr><tr><td>5</td><td></td><td>PHP</td><td>6.02 %</td><td>-0.9 %</td></tr><tr><td>6</td><td></td><td>C/C++</td><td>5.69 %</td><td>-0.2 %</td></tr><tr><td>7</td><td></td><td>R</td><td>3.86 %</td><td>-0.1 %</td></tr><tr><td>8</td><td></td><td>Objective-C</td><td>2.5 %</td><td>-0.3 %</td></tr><tr><td>9</td><td></td><td> Swift</td><td>2.24 %</td><td>-0.1 %</td></tr><tr><td>10</td><td>个</td><td>TypeScript</td><td>1.86 %</td><td>+0.2 %</td></tr></table></body></html>

·Python是首选的数据分析语言  
·在数据分析/数据科学领域中占有率 $70 \%$   
·有强大的生态（社区 $+$ 工具）  
科学计算：Sklearn,Numpy, Pandas  
人工智能：Tensorflow,PyTorch  
网络爬虫： Scrapy, Request, BeautifulSoap  
运筹优化：ortools,pulp  
Python生态强大，代码简洁

相对其他语言Python更好上手，浙江高考将Python列为可选科目之一

# 学习Python可以从以下3个维度掌握

·基础语法  
输入，输出，条件判断，循环语句，注释，引用包，函数定义  
·数据结构  
列表、元组、字典、集合  
·常用分析工具  
Numpy, Pandas

# Python基础语法

·输入输出   
name $\mathbf { \tau } = \mathbf { \tau }$ input("What's your name?")   
$\mathsf { s u m } = 1 0 0 { + } 1 0 0$   
print ('hello',name)   
print ('sum',sum)

# Python基础语法

·条件判断if...else...   
score = 95   
if score>= 90: print('Excellent')   
else: if score < 60: print('Fail') else: print('Good Job')

# Python基础语法

·循环语句for...in   
$\mathsf { s u m } = 0$   
for number in range(11): sum= sum $+$ number   
print(sum)   
·循环语句while   
sum=0   
number $= 1$   
while number $< 1 1$ ： sum $\mathbf { \tau } = \mathbf { \tau }$ sum +number number $\mathbf { \tau } = \mathbf { \tau }$ number + 1   
print(sum)

# Python基础语法

·注释 # -\*- coding: utf-8 -\*

三

这是多行注释，用三个单引号这是多行注释，用三个单引号这是多行注释，用三个单引号

三

·引用模块/包：import  
#引用一个或多个包  
import module_name1,module_name2  
#导入包中指定模块  
from package_name import moudule_nam

函数定义def def addone(score): return score + 1 print(addone(99))

# Python数据结构

数据类型：列表、元组、字典、集合  
列表：[]  
$| | \boldsymbol { \mathsf { s t s } } = [ ^ { \prime } \mathsf { a } ^ { \prime } , ^ { \prime } \mathsf { b } ^ { \prime } , ^ { \prime } \mathsf { c } ^ { \prime } ]$   
·元组(tuple)  
tuples $\mathbf { \tau } = \mathbf { \tau }$ ('tupleA','tupleB')  
·字典{dictionary}  
score $\mathbf { \sigma } = \mathbf { \sigma }$ {'guanyu':95,'zhangfei':96}  
·集合：set  
$\mathsf { s } = \mathsf { s e t } ( [ ^ { \mathsf { \prime } } \mathsf { a } ^ { \prime } , ^ { \mathsf { \prime } } \mathsf { b } ^ { \prime } , ^ { \mathsf { \prime } } \mathsf { c } ^ { \prime } ] )$

# Python数据结构 （列表）

# #列表

lists $\mathbf { \tau } = \mathbf { \tau }$ ['zhangfei','guanyu','liubei'] #列表中添加元素 lists.append('dianwei") print(lists) print(len(lists))

#在指定位置添加元素lists.insert(O,'diaochan')

#删除末尾元素   
lists.pop()   
print(lists)

Thinking：什么是人工智能？

The theory and development of computer systems able to perform tasks normally requiring human intelligence.

-- Oxford Dictionary

Using data to solve problems.

--cy

# Using data to solve problems

![](images/c07fd460ff48f72d8bd86252c3e7c34b974b2464aa180bf4cbe26ea167e6f224.jpg)

# AI的本质

AI就是利用数据，解决问题Using data to solve problemsTraining PredictionUsing data solve problems训练阶段：通过对数据的训练， 创建一个预测模型并对其进行微调

![](images/c6fb044ac01017253feced0f4a1cac22c4c5553f3c42bcd57359875d2830d35d.jpg)

模型生成：预测模型可以从这些数据背后找出答案来， 帮我们解决某个问题

预测阶段：通过测试集完成模型评估，从而了解模型在测试集中的有效性

过程中，预测模型会被不断改进和使用。

# 机器学习的步骤

·Thinking：如何预测房价？

# 机器学习的7个步骤

![](images/4c42b48626f12d95d77e218b845a227b1359584d5107e0e9b45c3e8482c5a4a8.jpg)

# 机器学习的步骤

·Thinking：如何预测房价？

![](images/be1dc86fb3a57e6fca0ecb73b16e2a92d09b2c7b196abeca8f5d77fa562b1c0f.jpg)

<html><body><table><tr><td>房间大小x</td><td>房价y</td></tr><tr><td>50</td><td>82</td></tr><tr><td>80</td><td>118</td></tr><tr><td>100</td><td>172</td></tr><tr><td>200</td><td>302</td></tr><tr><td>···</td><td>···</td></tr></table></body></html>

# 机器学习的训练过程

·训练是机器学习的主要步骤

·针对预测房价这个例子，我们可以用简单的线性模型： $V = W ^ { \ast } x + b$

![](images/b1256782e22b1a5f6a689d9d53af44d2e76a545c6e5f037f78569e2e047116c1.jpg)

# 机器学习的训练过程

·在机器学习中，我们有很多特征，基于这些特征，我们需要训练在Model中的权重w  
·这些特征值构成的矩阵，称之为权重矩阵weights  
·同时，还存在偏差，称之为biases

<html><body><table><tr><td>房间大 小</td><td>区域</td><td>周围绿 化</td><td>周边配 套</td><td>房型</td><td>房价y</td></tr><tr><td>50</td><td>海淀</td><td>A</td><td>A</td><td>style1</td><td>82</td></tr><tr><td>80</td><td>通州</td><td>B</td><td>A</td><td>style1</td><td>118</td></tr><tr><td>100</td><td>朝阳</td><td>C</td><td>B</td><td>style2</td><td>172</td></tr><tr><td>200</td><td>海淀</td><td>C</td><td>C</td><td>style3</td><td>302</td></tr><tr><td>……·</td><td></td><td>……</td><td>……·</td><td>…….</td><td>……·</td></tr></table></body></html>

$$
f ( x ) = w _ { 1 } x _ { 1 } + w _ { 2 } x _ { 2 } + . . . + w _ { d } x _ { d } + b
$$

$$
f ( x ) = \mathbf { w } ^ { T } \mathbf { x } + b
$$

# 机器学习的训练过程

·机器学习的过程，就是在搜索空间中对W和B进行搜索的过程，使得模型的准确率达到某个标准

·一个训练步骤(trainingstep)，称之为一次迭代。目的在于更新权重和变量

·通过多次迭代，模型中的参数不断进行更新。就好像是在数据中进行线性拟合

·当完成训练时，可以使用模型对房价进行预测

![](images/6ba7224071cf09dbf112d1ae916df5ae1e273daeab54a8a77e7305d767cc1b47.jpg)

# 机器学习的模型选择

·Thinking：什么是回归问题，什么是分类问题？

·Thinking：什么是线性回归，什么是逻辑回归？

# 机器学习的模型选择

·判断一个问题是分类，还是回归：输出的数据类型：离散or连续

·线性回归：

$$
\begin{array} { l } { f ( x ) = w _ { 1 } x _ { 1 } + w _ { 2 } x _ { 2 } + \ldots + w _ { d } x _ { d } + b } \\ { f ( x ) = \mathbf { w } ^ { T } \mathbf { x } + b } \end{array}
$$

·逻辑回归：

使用sigmod函数，实际上是分类算法

![](images/fe42a99e66139494832e01d1b504f73aa2bd055af9297beff1ced4eec3fa2b09.jpg)

# 机器学习的模型选择

·Thinking：如何判断杯子里盛的是水，还是饮料？

![](images/812add132946b9069ce1109d53e9df02ce0820c088666e30601bddcad926c303.jpg)

# 机器学习的模型选择

<html><body><table><tr><td>Color</td><td>Sugar</td><td>Classification</td></tr><tr><td>252</td><td>0.1%</td><td>water</td></tr><tr><td>210</td><td>4%</td><td>beverage</td></tr><tr><td>150</td><td>8%</td><td>beverage</td></tr><tr><td>250</td><td>0.5%</td><td>water</td></tr><tr><td>····</td><td>…··…</td><td>·····</td></tr></table></body></html>

可见光的波长为 $4 0 0 \sim 7 6 0 \mathrm { n m }$ ，白色是包含光谱中所有颜色的集合因此采用color这里采用颜色值

# 机器学习的模型选择

![](images/2b131f6e3699c43d6ea420f9c58fa70ebfc00bea94621b0695718b4e9bf452ca.jpg)

# 机器学习的特征构造

# 如何用线性回归模型拟合非线性关系

![](images/7a3c74ae78120f4880017f0905a2049407bf9d2d3bc50b9d961d8e75edd99444.jpg)

# 机器学习的评估

·对数据的评估有多种方式：·我们通过会选择一部分数据作为测试集，比如20%或者10%

省 省 Training Evaluation 80% 20%

# 超参数调整

·我们还可以对模型中的参数进行调整，比如epoch的次数，学习率等·这些参数通常被称为超参数。调整超参数的过程比起科学更像是艺术。这是实验性的过程，并很大程度上取决于具体的数据集、模型和训练过程

# 数据分析模型

# ——10大经典模型

·分类算法：C4.5，朴素贝叶斯（Naive Bayes），SVM，KNN，Adaboost， CART

·聚类算法：K-Means，EM

·关联分析：Apriori

·连接分析：PageRank

# 数据分析模型

# 主流模型

Logistic Regression,Decision Trees, RandomForests在业界依然是主流

![](images/c259a71f67eeaed2bd059121fde0a1bd7bb2374603a51e6d1c21e649ff8423d2.jpg)

![](images/da0e0d8d5e8e7a991499d0fea831c82b08a50ddc1e8fe2dbcade426028f91b91.jpg)

# Thinking& Action

# Action：寿险客户续保预测

寿险行业是一个高度依赖于客户忠诚度和持续支付保费的领域。准确预测客户是否续保可以帮助保险公司提前采取措施，减少流失率，比如提供更加个性化的服务或者优化产品设计。

训练集：train.csv 1000条   
测试集：test.csv200条   
https://www.kaggle.c0m/t/467370365f17478   
68eadbd65eeb970c5

<html><body><table><tr><td>英文名称</td><td>含义描述</td></tr><tr><td>policy_id</td><td>每个保单的唯一标识符</td></tr><tr><td>age</td><td>客户的年龄，范围从18岁到70岁。</td></tr><tr><td>gender</td><td>客户的性别，分为"男"和"女"。</td></tr><tr><td>birth_region</td><td>客户的出生地</td></tr><tr><td>insurance_region</td><td>客户投保时所在的地区</td></tr><tr><td>lincome_level</td><td>客户的收入水平，分为"低"、“中"和"高"。</td></tr><tr><td>education_level</td><td>客户的最高教育程度，分为"高中"、“本科"、“硕士"和"博士"。</td></tr><tr><td>occupation</td><td>客户的职业，例如"销售”、“经理"、“设计师"、“工程师"、“医生"等。</td></tr><tr><td>marital_status</td><td>客户的婚姻状况，分为"单身"、“已婚"和"离异"。</td></tr><tr><td>family_members</td><td>客户的家庭成员数量，单身客户通常有1-2人，已婚客户通常有3-6人，</td></tr><tr><td>policy_type</td><td>保单的类型，例如"平安六福保"、“盛世福尊悦版"、“优悦版"等。</td></tr><tr><td>policy_term</td><td>保单的有效期限，分为"1年"、“5年"、“10年"和"20年"。</td></tr><tr><td>premium_amount</td><td>客户每年需要支付的保费金额</td></tr><tr><td>policy_start_date</td><td>保单开始生效的日期</td></tr><tr><td>policy_end_date</td><td>保单到期的日期，根据保单生效日期和保单期限计算。</td></tr><tr><td>claim_history</td><td>保单是否有过理赔记录，分为"是"和"否"。</td></tr><tr><td>renewal</td><td>是否续保，Yes或者No</td></tr></table></body></html>

# 决策树与随机森林

# 决策树：

·决策树基本上就是把我们以前的经验总结出来

·常见的决策树算法有C4.5、ID3和CART

·Thinking：如何构造一个判断是否去打篮球的决策树

将哪个属性（天气、温度、湿度、刮风）作为根节点是个关键问题

<html><body><table><tr><td>天气</td><td>温度</td><td>湿度</td><td>刮风</td><td>是否打球</td></tr><tr><td>晴天</td><td>高</td><td>中</td><td>否</td><td>否</td></tr><tr><td>晴天</td><td>高</td><td>中</td><td>是</td><td>否</td></tr><tr><td>阴天</td><td>高</td><td>高</td><td>否</td><td>是</td></tr><tr><td>小雨</td><td>高</td><td>高</td><td>否</td><td>是</td></tr><tr><td>小雨</td><td>低</td><td>高</td><td>否</td><td>否</td></tr><tr><td>晴天</td><td>中</td><td>中</td><td>是</td><td>是</td></tr><tr><td>阴天</td><td>中</td><td>高</td><td>是</td><td>否</td></tr></table></body></html>

# 决策树与随机森林

信息、熵以及信息增益：

·引用香农的话来说，信息是用来消除随机不确定性的东西·对于机器学习中的决策树而言，如果带分类的事物集合可以划分为多个类别当中，则某个类（xi）的信息可以定义为

$$
\boxed { I \big ( X = x _ { i } \big ) } = - \log _ { 2 } \boxed { P \big ( x _ { i } \big ) }
$$

随机变量的信息 当xi发生时的概率

·熵是约翰.冯.诺依曼建议使用的命名，熵 $\mathbf { \bar { \rho } } = \mathbf { \rho }$ 信息的期望值

$$
H ( X ) = \sum _ { i = 1 } ^ { n } p { \big ( } x _ { i } { \big ) } I { \big ( } x _ { i } { \big ) } = - \sum _ { i = 1 } ^ { n } p { \big ( } x _ { i } { \big ) } \log p { \big ( } x _ { i } { \big ) }
$$

熵用来度量不确定性的，当熵越大， $x = x i$ 的不确定性越大对于机器学习中的分类问题，熵越大 $\Rightarrow$ 这个类别的不确定性大·信息增益在决策树算法中是用来选择特征的指标，信息增益越大，则这个特征的选择性越好信息增益 $g \left( D , A \right) = H \left( D \right) - H \left( D \mid A \right)$ 原有树的熵 $\mathsf { H } ( \mathsf { D } )$ 增加了一个分裂节点，使得熵变成了 ${ \mathsf { H } } ( { \mathsf { D } } | { \mathsf { A } } )$

![](images/7373bd04727844d1e130bc833300205586564f487198bc0d623230a612b3f6db.jpg)

# 决策树与随机森林

# 随机森林的生成：

·森林中的每棵树都是独立的  
·bagging思想，将若干个弱分类器的分类结果进行投票选择，从而组成一个强分类器  
·bagging不用单棵决策树来做预测，增加了预测准确率，即不容易过拟合，减少了预测方差

![](images/729056dca7e059e7393c135e97c52a3845b3f07d49aa3df91b181515fa81b1c0.jpg)

少数服从多数，获得票数最多的类别就是森林的分类结果

# Thank You Using data to solve problems