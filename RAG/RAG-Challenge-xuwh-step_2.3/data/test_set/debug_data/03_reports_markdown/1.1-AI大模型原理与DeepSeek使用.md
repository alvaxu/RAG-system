# Al大模型原理与DeepSeek使用

# 和计算机、算法相关

（10岁，清华计算机博士，NOI，ACM比赛，ACM，IEEE，中国人工智能协会，阿里云MVP，CCF专委）

# 和培训、 企业服务相关

(专栏付费订阅人数超过17万，企业客户包括：蚂蚁金服，美的，汽车之家，上汽大众，晶科能源，航天信息，中国银行，中国银联，花旗银行，汇丰银行，杭州银行，泰隆银行，中原银行，长沙银行，渤海银行，平安银行，平安保险，平安科技，阳光保险，兴业银行，兴业数金，上海银科，尚诚金融，嘉银金科，马上金融，中泰证券，富达基金，大恒集团，华润集团，中国外汇交易中心，联通软研院，梅赛德斯奔驰，雀巢，麦当劳，西门子等)

![](images/d9d6463e969063300ff97659bf1970c8fe08f8d75f2c7a46bc2ba1701c6d5b96.jpg)

# 学习方法

· Thinking: behind the theory,original from the real problem

·Action: solve problems by tools,present the results

# 今天的学习目标

# Al大模型原理与DeepSeek使用

AIGC发展：从GPT1到GPT4AIGC的表现与优势AIGC的通用能力应用·大模型API使用CASE-情感分析-QwenCASE-天气Function-QwenCASE-表格提取-QwenCASE-运维事件处置-Qwen

·DeepSeek的创新   
CASE：小球碰撞试验（Cursor $^ +$ DeepSeek-R1)   
DeepSeek私有化部署选择   
Ollama部署DeepSeek-R1   
API调用DeepSeek

# 什么是AI

AI的核心目标是让机器能够执行通常需要人类智能的任务，例如语言理解、图像识别、复杂问题解决等·早期阶段：以规则为基础的专家系统，依赖预设的逻辑和规则·机器学习时代：通过数据训练模型，使机器能够从数据中学习规律。·深度学习时代：利用神经网络模拟人脑的复杂结构，处理更复杂的任务。·大模型时代：以大规模数据和算力为基础，构建通用性强、性能卓越的AI模型

# AI的分类

# 分析式AI

# 生成式AI

，也称为判别式AI，其核心任务是对已有数据进行分类、预测或决策。·优势在于其高精度和高效性，但其局限性在于仅能处理已有数据的模式，无法创造新内容。

·专注于创造新内容，例如文本、图像、音频等。突破在于其创造性和灵活性，但也面临数据隐私、版权保护等挑战

# 大语言模型

莫型是一种通用自然语言生成模型，使用大量预料数据训练，以实现生成文本、回答问题、对话生成等

# 基本能力

语言生成上下文学习世界知识"超”能力响应人类指令泛化到没有见过的任务代码生成和代码理解

![](images/7eb946515d4f657c1cbac859bcfbb55414aa11965cbeeaf03c3d61956a7c3baf.jpg)

# 从GPT1到GPT4

# GPT-2(15亿参数)

![](images/3af5e23d65b86a09037d56c08851373423c81b36cbdedce838a18299d9bec977.jpg)

ChatGPT的“超能力”是由InstructGPT演化而来的

# ChatGPT是如何训练出来的？

![](images/c68707236a5c56386c031a2e6aa1c18cd3ca63f1909436240348414dd39a9393.jpg)  
步骤1：收集数据，微调监督模型

![](images/7208bf338319688a56dd1e80c3860cb39aa802960be0bf2873de1968071c3972.jpg)  
步骤2：收集比较数据，训练奖励模型  
步骤3：收集数据，强化学习优化模型  
ChatGPT微调 (基于Reward Model)

# ChatGPT是如何训练出来的？

![](images/4dc2668af26821b97534371b0a7ed5bae913db6431806ce0d84931464dcb8a29.jpg)

用排序任务代替打分任务，更容易让标注员给出统一的标注结果

# RankList标注平台

用于生成模型生成RankList的标注。

标注思路参考自InstructGPT。

RLHF更多介绍：想训练ChatGPT?..

# Model Config

当前标注配置（可在源码中修改）：

L"model_name":"uer/gpt2-chinese-cluecorpussmall""device":"cuda:0""dataset_file":"data/human_labeled/total_dataset.t"rank_list_len":4"max_gen_seq_len":40"random_prompts":[0："今天我去了"1："这部电影很"2："刚收到货，感觉"3："这部电影很"4："说实话，真的很"5：“这次购物总的来说体验很"

# SettingPrompts

# 随机prompt

prompt:

今天早晨我去了

GenerateResults

句子1排名 句子2排名 句子3排名 句子4排名4 3 2今天早晨我去了，一大早出来 今天早晨我去了车站，等她下 今天早晨我去了教堂，那里是 今天早晨我去了美国，想和你时还是一位穿着灰蓝色t恤 面等车，我看到她手里拎着 我的大学。你从我们学校走 出去玩。我先去了美国，想的老奶奶。这时门口一个白 个小提着小箱子在走，大家 出走到我的课堂，我仿佛看 去了之后，又打电话问他的发苍苍 都不会 到了我 情况时Rank ResultsRank 1: Rank 2: Rank 3: Rank 4:今天早晨我去了教堂，那里是今天早晨我去了美国，想和你 今天早晨我去了车站，等她下今天早晨我去了，一大早出来我的大学。你从我们学校走 出去玩。我先去了美国，想面等车，我看到她手里拎着时还是一位穿着灰蓝色t恤出走到我的课堂，我仿佛看 出走到我的课堂，我仿佛看去了之后，又打电话问他的个小提着小箱子在走，大家的老奶奶。这时门口一个白到了我 情况时 都不会 发苍苍

# 存储当前排序

# ChatGPT的优势

![](images/ce6d1f21376ed6dc5efb5fad2ac368df0644f5c8fef4ddea3891ec53ea813a5b.jpg)

<html><body><table><tr><td>模型</td><td>发布时间</td><td>参数量</td><td>预训练数据量</td></tr><tr><td>GPT</td><td>2018年6月</td><td>1.17亿</td><td>约 5GB</td></tr><tr><td>GPT-2</td><td>2019年2月</td><td>15亿</td><td>40GB</td></tr><tr><td>GPT-3</td><td>2020年5月</td><td>1,750亿</td><td>45TB</td></tr></table></body></html>

![](images/b970e796060df4b3a4a9d4a0a0b555f22172f47d19ab658f2b84933d9decc811.jpg)  
基于人类反馈的强化学习 (RLHF) Reinforcement Learning from Human Feedback

# ChatGPT的表现

# 让亚里士多德写浦发银行信用卡的使用介绍

# 使用Python连接MySQL，查询customers表的样例

# 帮我写一篇SKI神仙水的试用报告

以亚里士多德的口吻写一篇浦发银行信用卡使用的介绍亲爱的朋友们，我是亚里士多德，今天我来向大家介绍一下浦发银行信用卡的使用方法。

首先，信用卡是一种非常方便的工具，可以在您购物时提供资金支持。浦发银行信用卡可以帮助您实现定期还款和一次性还款两种方式，让您自由选择。借助信用卡，您可以消费后再次在还款日还清相关费用。此外，浦发银行信用卡还为您提供了灵活的分期付款方案，让您能够轻松地管理支付金额及账单日。

其次，我们为您准备了专业服务团队，您可以通过在线客服、电话客服等方式获得快速便捷的服务。浦发银行信用卡还可以为您提供多种特色福利，如免费旅游保险、购物的优惠券、机场贵宾室等。

最后，我们强调，“用信用卡，要懂得控制”。在使用信用卡时，请确保自己的还款能力，避免因欠款而导致信用卡的透支。记住，信用卡是一种有力的支付工具，同时也需要您的理智和谨慎操作。

总之，浦发银行信用卡是一种非常方便的消费工具，希望我们的专业团队和贴心福利能够让您享受到更多的便利。如果您还有其他任何问题或需求，请随时与我们联系。感谢您的阅读。

# 用不同语言说“浦发银行赞助了2023上海半程马拉松

用不同语言说“浦发银行赞助了2023上海半程马拉松中文：浦发银行赞助了2023上海半程马拉松。英文：BankofShanghaisponsoredthe2023ShanghaiHalfMarathon.法语：Banquede Shanghaiasponsorisélesemi-marathonde Shanghai2023.德语：Die BankofShanghaisponserteden HalbmarathonvonShanghai2023.西班牙语：El BancodeShanghaipatrocinoelMedioMaratondeShanghai2023日语：浦凳銀行2023年上海ンサまた。：

好的，以下是一个使用Python 连接MySQL数据库并查询customers表的样例：

# importmysql.connector

#创建数据库连接   
mydb=mysql.connector.connect( host="localhost",   
user="root",   
password="password", database="mydatabase"   
#创建游标   
mycursor=mydb.cursor(   
#执行SQL查询语句   
mycursor.execute("SELECT\*FROMcustomers")

#获取查询结果 myresult =mycursor.fetchall()

输出结果   
forxinmyresult:   
print(x)

# 用Python3.7编写一个爬虫代码

用Python3.7编写一个爬虫代码

好的，我给你提供一个简单的爬虫代码样例，可以用来爬取一个网站中所有的图片链接。代码如下：

复制代码

import requests   
from bs4 import BeautifulSoup   
url = "https://unsplash.com/\*   
resp = requests.get(url)   
soup=BeautifulSoup(resp.text,'html.parser'   
for img insoup.find_all(‘img'): print(img['src'])

这个简单的代码可以爬取Unsplash网站上的所有图片链接，并打印在控制台上。当然，你可以根据自己的需求，修改代码来爬取其他网站的不同信息。

在使用Python编写爬虫时，需要了解相关的库和模块，如requests、beautifulsoup4、selenium、re等，并且要遵循爬虫的规范和友好协议，以免侵犯他人利益或对网站服务器造成不必要的负担。

好的，以下是一篇SK-I神仙水的试用报告：

作为一款备受欢迎的美容产品，SK-I神仙水被誉为“神奇“的肌肤转换液，在不断地挑战着人们对于肌肤护理的认知。所以我非常期待能够亲身体验这款产品，并且分享我的试用感受。

首先，我想说的是神仙水真的很好用。我使用它的时间不长，但觉得它能给肌肤带来非常明显的改变。它的质地非常轻盈，不油腻，很容易吸收。每次使用后，我的脸都会感到更加清爽和滋润，同时我也发现了细小的皱纹和色斑逐渐减少了。

其次，我喜欢神仙水的味道。有些护肤品传统的药物气味总让我感到不舒服，而神仙水却闻起来非常清新，有一种淡淡的香味，让我每次使用它的时候都感到舒适和放松。

我还很喜欢神仙水的包装。它的瓶子很漂亮，简洁而富有设计感，给人一种高档、优雅的感觉。并且由于使用方法简单，瓶口也非常方便，使用时不会浪费很多。

最后，我觉得神仙水的价格值得。虽然价格比一些大众化的护肤品要贵一些，但是和市面上其他高端护肤品价格相比，它的价格并不算过份。而且，它的确能够带来肌肤的巨大变化，所以还是很值得购买的。

总的来说，我的试用体验非常愉快，神仙水真的对我的肌肤产生了明显的积极影响，让我愿意再次购买并继续使用。如果您正在寻找一款有效护肤品，我强烈推荐SK-I神仙水。

# 代码阅读理解

# apply template matching to find the template in the image   
result $= c \mathsf { v } 2$ matchTemplate(resized,card,cv2.TM_CCOEFF_NORMED)   
(_,maxVal, $\_$ maxLoc) $\mathbf { \sigma } = \mathbf { \sigma }$ cv2.minMaxLoc(result)   
# if we have found a new maximum correlation value, then update   
# the bookkeeping variable   
if found is None or maxVal $>$ found[0]:   
found $\mathbf { \Sigma } = \mathbf { \Sigma }$ (maxVal, maxLoc,r,scle2)   
return(found)

这是一个图像匹配算法的代码实现，通过输入一张待匹配的参考卡片和一组搜索参数，返回在原图像中找到的最佳匹配。以下是代码的逐行解释：

def paralell_search(search_scale，degree，gray，H_card，W_card，card)::定义一个函数，该函数使用并行计算方法对图像进行搜索。found $\mathbf { \Sigma } = \mathbf { \Sigma }$ None：初始化一个变量found，用于存储匹配到的最佳结果。if degree isnot0:：如果给定的搜索角度degree不为零，则将待匹配图像进行旋转操

# 应用场景：AI客服

假如你是一名银行客服人员，我是访问你们网站的顾客，你的目的是获取我的电话号码。但是为了获取电话号码，你要帮我解决一些我提出的问题你觉得解决了问题之后，你想他要电话号码，这样成功率会比较高。现在让我们开始吧

假如你是一名银行客服人员，我是访问你们网站的顾客，你的目的是获取我的电话号码。但是为了获取电话号码，你要帮我解决一些我提出的问题，你觉得解决了问题之后，你想他要电话号码，这样成功率会比较高。现在让我们开始吧

C

非常好的想法，为了更好地帮助您解决问题，我需要了解您遇到了哪些具体问题。可以告诉我您目前遇到的问题是什么吗？

我想借10万人民币

H

非常感谢您对我们银行的信赖与支持。在申请借款时，我们需要了解您的具体情况，如收入情况、工作稳定性、信用记录等。请问您是否已经有我行的账号或信用卡？如果有，您可以登录网上银行或者拨打客服热线进行咨询。如果没有，我们也可以帮您开通账户并提供更多信息。同时，您也可以向我提出更多的问题，以便我们更好地帮助您。

收入稳定，每个月5万，信用记录良好

GPT-3.5

感谢您提供的信息。根据您的描述，您似乎是一位收入稳定、信用记录良好的客户。在这种情况下，如果您需要10万人民币的贷款，我们可以为您提供多种选择。最快速的途径是通过我们的网上银行进行申请。您可以登录网银，选择"贷款申请"并填写相应的信息。我们的工作人员将在提交申请后尽快审核并通知您。

当然，如果您更愿意与我们的客服人员进行一对一的交流，了解更详细的贷款方式和利率，您可以拨打我们的客服热线，我们的工作人员将会为您提供更加个性化和专业的服务，并在更短的时间内帮助您成功申请到贷款。需要您提供您的电话号码，以便我们方便地与您联系。

# GPT-3.5

Thinking: ChatGPT作为银行客服， 你会打几分？

以前的智能客服：关键词匹配

ChatGPT做智能客服：懂客户，懂指令，善于沟通

# 应用场景：AI写代码

让生成式AI编写反欺诈分析和预测代码：告诉他 train.csv,test.csv，需要处理的流程让生成式AI告诉我们在反欺诈预测中，有哪些特征是关键的？

import lightgbm as lgb import matplotlib.pyplot as plt #训练LightGBM模型（使用示例中的训练集和目标列） model = lgb.train(params，train_dataset，num_boost_round=100)

# 获取特征重要性 feature_importance = model.feature_importance() feature_names = model.feature_name()

# 创建特征重要性的数据框 feature_importance_df = pd.DataFrame({'Feature': feature_names, 'Importance # 按照重要性降序排序 feature_importance_df = feature_importance_df.sort_values(by='Importance'

# 可视化特征重要性

plt.figure(figsize=(1O，6))   
plt.barh(feature_importance_df['Feature']，feature_importance_df['Importance   
plt.xlabel('Importance')   
plt.ylabel('Feature')   
plt.title('Feature Importance')   
plt.show()

![](images/2159ab8aa87de229c3b19e6a1630d9dc71ab78dad5c647b50debcc7cce26069c.jpg)

# Case: 车险反欺诈预测

Case：保险反欺诈预测 https://www.kaggle.com/c/fraud-detection-ininsurance-claims

保险公司向你提供了之前客户索赔的车险数据，希望你能开发模型帮助他们预测哪些索赔是欺诈行为

训练集：train.csv 700条 测试集：test.csv300条

字段 说明 months_as_customer 成为客户的时长，以月为单位 age 年龄 policy_number 保险编号 policy_bind_date 保险绑定日期 policy_state 上保险所在地区 policy_csl 组合单一限制CombinedSingle Limit policy_deductable 保险扣除额 policy_annual_premium 每年的保费 umbrella_limit 保险责任上限 insured_zip 被保人邮编 insured_sex 被保人姓名：FEMALE或者MALE insured_education_level 被保人学历 linsured_occupation 被保人职业 insured_hobbies 被保人兴趣爱好 insured_relationship 被保人关系 capital-gains 资本收益 capital-loss 资本损失

# Case: 车险反欺诈预测

<html><body><table><tr><td>字段</td><td>说明</td></tr><tr><td>incident_date</td><td>出险日期</td></tr><tr><td>incident_type</td><td>出险类型</td></tr><tr><td>collision_type</td><td>碰撞类型</td></tr><tr><td>incident_severity</td><td>事故严重程度</td></tr><tr><td>authorities_contacted</td><td>联系了当地的哪个机构</td></tr><tr><td>incident_state</td><td>出事所在的州</td></tr><tr><td>incident_city</td><td>出事所在的城市</td></tr><tr><td>incident_location</td><td>出事所在的具体位置</td></tr><tr><td></td><td>incident_hour_of_the_day出事所在的小时（一天24小时的哪个时间)</td></tr><tr><td>number_of_vehicles_invol ved</td><td>涉及的车辆数</td></tr><tr><td>property_damage</td><td>是否有财产损失</td></tr><tr><td>bodily_injuries</td><td>身体伤害</td></tr><tr><td>witnesses</td><td>目击证人</td></tr><tr><td>police_report_available</td><td>是否有警察记录的报告</td></tr><tr><td>total_claim_amount</td><td>整体索赔金额</td></tr><tr><td>injury_claim</td><td>伤害索赔金额</td></tr><tr><td>lproperty_claim</td><td>财产索赔金额</td></tr></table></body></html>

<html><body><table><tr><td>字段</td><td>说明</td></tr><tr><td>vehicle_claim</td><td>汽车索赔金额</td></tr><tr><td>auto_make</td><td>汽车品牌，比如Audi, BMW,Toyota, Volkswagen</td></tr><tr><td>auto_model</td><td>汽车型号，比如A3,X5,Camry,Passat等</td></tr><tr><td>auto_year</td><td>汽车购买的年份</td></tr><tr><td>fraud_reported</td><td>是否欺诈，1或者0</td></tr><tr><td>c39]</td><td>无意义</td></tr></table></body></html>

评测标准：AUC

TPRate

![](images/a9c7fdec2dc5be11cd6c0dddbea87de893422dbe146b7838665ccd44495362c4.jpg)

# 应用场景：AI写代码

Thinking：为什么ChatGPT会写代码?

·Codex基于GPT-3使用code数据进行了Fine-Tuning，它经过了自然语言和几十亿的代码的训练·学习的语言包括：JavaScript,Go,Perl, PHP,Ruby,Swift,TypeScript, SQL, Shell

不仅是代码， 其他工作也是类似 (比如写方案） 写文章)

# ChatGPT写代码的不足：

·很难一次完成你的需求，通常需要交互9-10次能达到你的期望  
需要Manager了解自己的需求，并指出ChatGPT作业的不足

# ChatGPT写代码的优势：

·效率很高，只要你给出具体的指令，1秒后出结果·代码质量比一般人好（很博学，各种任务都能完成有代码注释，可以给你将每一个代码模块的解释)

# GPT Moment

# 机器语言

# 汇编语言

# 高级语言

# 自然语言

01100010100001000010101  
10101101010100000011101  
10000001010101001110001  
10000001110'WannaCrypt  
00101000000001010101001  
10101010000001110110010  
AX=1000 BX=0100 CX=000C DX=0000 SP=FFFA  
DS=075A ES=075A SS=0769 CS=0000 IP=020F  
9000:020F8CC8 MOU AX,CS  
-u 0:020f  
9000:020F8CC8 MOU AX,CS  
0000:02118ED8 MOU DS,AX  
0000:0213BE0202 MOU SI,0202  
0000:0216 B800B8 MOV AX,B800  
0000:02198EC0 MOV ES,AX  
0000:021BBFC807 MOV DI,07C8  
0000:021EB90D00 MOV CX,000D  
0000：0221 8A04 MOV AL,[SI]  
9000:022326 ES:  
9000：0224 8805 MOU [DI],AL  
0000:022646 INC SI  
0000：022783C702 ADD DI,+02  
0000:022AE2F5 LOOP 0221  
0000:022C B8004C MOV AX,4C00

intx[SIZE],i,max,min; printf("Enter10 integers:\n"); for(i=0;i<SIZE;i++) printf("%d:",i+1); scanf("%d",&x[i]); 1

![](images/853724b932db14b721e6dad52998dcd7559035cd00a8f88035bac1d4e85aa666.jpg)

Thinking: GPT出现的意义是什么？

让人们通过自然语言可以工作，Prompt Engineering是一种新的工作方式

Thinking: 除了用自然语言编程 GPT还能解锁我们的什么能力？

AI绘画，做动画，等专业性技能

Thinking：每个人都能抓住这个机会么？

使用自然语言编程的本质是解决问题

1）价值驱动 $\Rightarrow$ 解决什么问题很关键和你的工作场景相关，KPI相关，reward相关

# 2) 清晰的思考和表达

优秀Prompt Engineering的本质

![](images/fc01a622820171b96be8068cb59407075f6d3b37f622217f2345d54c401a78c1.jpg)

3）善于利用各种工具，来解决问题  
GPT不能直接帮你做动画，但它可以帮你生成动画软件的代码  
GPT的边界 $\mathbf { \sigma } = \mathbf { \sigma }$ 你的边界

# 大模型正广泛应用于各个行业中

![](images/2217561dd6681ccfe192bee751754fdebcfd00a1e6ffe935d0f4041dfb69fa2f.jpg)

![](images/ddab665e59a9980452804216ef3e95cd1c740b7a0b6123e9b4d9e7bf5c264d90.jpg)

![](images/b85d07ec25d7279c37a720c880ee6150d02ec2327773718fae168115bada77cf.jpg)

![](images/7a0fb3da2cefec9062841d96ce3845c4497ede5c99cbf68a64bb4b1ecab0763b.jpg)

保险条款智能解析文本处理效率提升30倍

金融信贷智能风控借贷风险判断准确率提升 $2 1 . 5 \%$

医学病例自动化抽取病例处理效率显著提升

候选人信息智能分类模型识别准确率达到 $9 9 \%$

![](images/6025d81c87e1d3ef73e76230e018a77baddeac991cc2b7b25cb51c125b2f1473.jpg)

![](images/4af74e95585c73589de0d5704b4d4eb28b925661c0246e8da9e4e416665f13af.jpg)

![](images/4d086d9feeb9da1faaa05ed3de2fe9eac060f155b654da4293e949f8157b80b8.jpg)

行业新闻信息抽取智能分析行业动态

![](images/3a40dabe3439210db9af49a873bbe98789d570294609e6a24627f981e69e2c6d.jpg)  
快递单物流地址智能识别与处理

短信内容智能分类与审核过滤效率显著提升

电商评论观点分析快速搭建评论数据分析系统

# Thank You Using data to solve problems