# 不同领域的AI算法

# 今天的学习目标

# 不同领域的AI算法

·金融行业的应用场景  
个人金融、公司金融、金融机构  
渠道运营、风险管理、资金交易、数字财务  
制造行业：缺陷检测快消行业：供应链补货  
AI大赛：二手车价格预测  
如何通过特征工程，进行模型调优

# 金融行业的应用场景

# Fintech应用场景

# Fintech:

Financial $^ +$ technology，通过科技手段，使得金融服务变得更加效率

金融业务：保险、银行、券商、基金需要有科技为其支撑。此外，互联网公司也在开展金融业务，如蚂蚁金服

高盛集团的总裁宣称：Weareatech firm.

近几年，摩根大通集团约有1/3的分析师和员工被逼迫加入编程课程学习

![](images/15f396bbbb0aa6a38a686c7f1971b290e0befbd64db6c94df992057633a6ab7a.jpg)

需求驱动技术发展需求驱动人才发展

# 银行不同部门的应用场景

# 1、个人金融：

个人金融部门利用数据算法为客户提供个性化服务，比如客户画像与精准营销、家庭财务规划

# 2、公司金融：

公司金融部门通过数据算法优化企业金融服务，比如：企业信用评估、供应链金融

# 3、金融机构：

对金融机构客户提供服务，运用银行自身资源，开展负债业务、资产业务和中间业务等，以获取综合效益。

# 4、渠道运营：

渠道运营部门利用数据算法提升客户体验和运营效率，比如客户行为分析、网点运营管理

# 5、风险管理：

风险管理是银行的核心职能之一，主要涉及：风险建模，市场风险预测，合规与监控

# 6、资金交易：

资金交易部门利用数据算法提升交易效率和风险管理比如算法交易、市场趋势预测

# 7、数字财务：

数字财务部门通过数据算法优化财务管理，比如财务预测与决策，智能融资决策

个人金融

# 客户流失分析与预警

场景：客户流失分析与预警

![](images/40511313fb5e2da3b8c5f9619a402c1052c48eac2a6a848c903c78f43d9a4ac3.jpg)

# 手机银行贷款页面优化

# 场景：手机银行贷款页面优化

：手机银行作为重要的媒介触点针对不同地域、不同客群、不同行为习惯的用户，匹配贷款产品千篇一律or猜你喜欢

![](images/f8c0fc781f2ca16b10f232841fde4a98cb5c5a4c75afa43d73a158deffc29c1f.jpg)

![](images/b72fdd52cb7ac75ae8a6df88fa797b04cc298be42cc79c2e666bd491cdfe059c.jpg)

# 标签落地应用 （易车案例）

![](images/7d3cdc7c448f8aed0ec91eb97b21f42939106658500518636fe8c4489c8decde.jpg)

# 因客定价

场景：因客定价

·利率可以基于借款人的信用、贡献度等因素进行差别化定价  
优质客户 $\Rightarrow$ 利率低一些  
普通客户 $\Rightarrow$ 利率高一些  
优质客户的衡量可以参考信用评分卡

第一部分：基本身份信息  

<html><body><table><tr><td></td><td></td><td rowspan="8">婚姻情况</td><td>未婚</td><td>5分</td><td></td></tr><tr><td>0-18</td><td>盼</td><td></td><td></td><td></td></tr><tr><td>18-24</td><td>1分</td><td>已婚</td><td>9分</td><td></td></tr><tr><td>25-29</td><td>8分</td><td>已婚有子女</td><td>10分</td><td></td></tr><tr><td>30-44</td><td>9分</td><td>已婚无子女</td><td>6分</td><td></td></tr><tr><td>45-54</td><td>8分</td><td>离异有子女</td><td>4分</td><td></td></tr><tr><td>55-48</td><td>3分</td><td>离异无子女</td><td>3分</td><td></td></tr><tr><td>60以上</td><td>1分</td><td colspan="2"></td><td></td><td></td></tr><tr><td>本地户籍</td><td>10分</td><td rowspan="4">现居住地址 (年)</td><td>1年以内</td><td>2分</td><td></td></tr><tr><td>其他户籍</td><td>2分</td><td>1-3年 (含)</td><td>6分</td><td></td></tr><tr><td>研究生及以上学</td><td>10分</td><td>3-5年 (含)</td><td>8分</td><td></td></tr><tr><td>大学本科</td><td>8分</td><td>5年以上</td><td>10分</td><td></td></tr><tr><td>大专</td><td>7分</td><td colspan="3"></td><td></td></tr></table></body></html>

<html><body><table><tr><td colspan="6">第二部分：工作信息</td></tr><tr><td rowspan="6">工作单位</td><td colspan="5">公务员事业单位教师银行从业人员 10 分</td></tr><tr><td colspan="5">国有企业大型上市公司员工</td></tr><tr><td colspan="5">解放军中国武警部队公安检查</td></tr><tr><td colspan="4">一般上市公司股份制公司私营企业员工</td><td>5分 6分</td></tr><tr><td colspan="4">个体户以及个体户从业者</td><td></td></tr><tr><td colspan="4"></td><td>3分</td></tr><tr><td rowspan="3">职位</td><td></td><td>首由职亚人员</td><td rowspan="3">职称</td><td rowspan="2">高级职称</td><td>盼 10分</td></tr><tr><td>高级领导</td><td>10分</td><td></td></tr><tr><td>中级领导 普通员工</td><td>8分 3分</td><td>中级职称 初级职称</td><td>6分 5分</td></tr><tr><td rowspan="6">现单位工作时间</td><td>0-6个月</td><td>盼</td><td rowspan="5"></td><td rowspan="5"></td><td></td></tr><tr><td>6个月-一年</td><td>1分</td><td></td></tr><tr><td></td><td>4分</td><td></td></tr><tr><td>1-3年 3-5年</td><td>7分</td><td></td></tr><tr><td>5年上</td><td>8分</td><td></td></tr><tr><td>无单位</td><td>盼</td><td></td><td></td><td></td></tr><tr><td colspan="7">第三部分：资产信息</td></tr><tr><td rowspan="4">房产信息</td><td>自有全款</td><td>6分</td><td rowspan="4">固有资产，房产车 产存款总值 (方 元)</td><td>50万以下</td><td>1分</td></tr><tr><td>自有按揭</td><td>10分</td><td>50-100万</td><td>2分</td></tr><tr><td>自建房</td><td>4分</td><td>100-200万</td><td>6分</td></tr><tr><td>租房</td><td>盼</td><td>200万以上</td><td>7分</td></tr><tr><td rowspan="5">保险信息</td><td colspan="5">购买人寿医疗健康分红理财保险1年</td><td>6分</td></tr><tr><td colspan="5">购买人寿医疗健康分红理财保险1-2年</td><td>8分</td></tr><tr><td colspan="5">购买人寿医疗健康分红理财保险2年以上</td><td>10分</td></tr><tr><td colspan="5">参加5险</td><td>9分</td></tr><tr><td colspan="5">参加5险一金</td><td>10分</td></tr><tr><td colspan="6">第四部分：负债比</td></tr><tr><td rowspan="6">负债比</td><td>0-10%</td><td>9分</td><td rowspan="6">家庭年收入</td><td>5万以下</td><td>盼</td></tr><tr><td>10%-20%</td><td>8分</td><td rowspan="4"></td><td>6-9万</td><td>1分</td></tr><tr><td>20%-40%</td><td>5分</td><td>10-15万</td><td>2分</td></tr><tr><td>40%-60%</td><td>4分</td><td>16-20万</td><td>4分</td></tr><tr><td>60%-80%</td><td>1分</td><td>20-30万</td><td>5分</td></tr><tr><td>80%以上</td><td>盼</td><td>30万以上</td><td>8分</td></tr></table></body></html>

# 因客定价

某银行推出个人消费贷，采用“因客定价”策略，根据借款人的信用状况、贡献度等因素，差异化设定利率。

1.优质客户：低利率客户信息

姓名：张先生  
信用评分：850分（分数区间：350-950分）  
贡献度：高（长期存款客户，持有银行理财产品）  
职业：大型企业高管  
收入：稳定且高于平均水平

# 定价逻辑

信用评分高，违约风险低，对银行贡献度高，属于高价值客户职业和收入稳定，还款能力强。

# 利率设定

基准利率： $5 \%$ 优惠利率： $4 . 2 \%$ （基于客户信用和贡献度下调0.8个百分点）

# 因客定价

2.普通客户：较高利率客户信息

姓名：李先生  
信用评分：650分（分数区间：350-950分）  
贡献度：中（仅持有普通储蓄账户）  
职业：自由职业者  
收入：波动较大

# 定价逻辑

信用评分中等，有一定违约风险。  
对银行贡献度一般，未达到优质客户标准。  
职业和收入稳定性较差，还款能力存在不确定性。

# 利率设定

基准利率： $5 \%$ 实际利率： $6 . 5 \%$ （基于客户信用和贡献度上浮1.5个百分点）

长尾客群营销  

<html><body><table><tr><td>经营</td><td>客群大类</td><td>经营目标</td><td>经营事件</td><td>经营策略</td><td>配置产品</td></tr><tr><td rowspan="5"></td><td>理财产品到期类</td><td>客群维稳</td><td>理财到期</td><td>结合客户产品持仓及风险情况，优先转化，其次续接</td><td>权益基金/分行卫星池产品</td></tr><tr><td>单一现金持仓</td><td>客群维稳</td><td>产品转化</td><td>利用产品转化提高整体收益率</td><td>权益类基全/黄金账户</td></tr><tr><td>资产缺配</td><td>客群维稳</td><td>资产配置</td><td>用料学的资产配置理念引导客户进行全面的配雪</td><td>金生利/权益类基金/债券基金等</td></tr><tr><td>预警流失模型客户</td><td>客群维稳</td><td>资产配置</td><td>定期回访切入，了解有户的后续资金安排情况，有针处生进行给 出合理建议，运用资产配置进行产品的领定。</td><td>资产配置的科学理念的应用</td></tr><tr><td>存款偏好客户</td><td>存款提升</td><td>定期回访</td><td>个给我行款结构性存款或者大题存款，进行新资金的引入，增加</td><td>结构性存款/大额存单</td></tr><tr><td rowspan="5">成长 期</td><td>存款偏好客户</td><td>存款提升</td><td>定期回访</td><td>介绍我行的结构性存款或者大额存款，进行新资金的引入，增加 客户的存款和AUM</td><td>结构性存款/大额存单</td></tr><tr><td>潜力资产模型客户</td><td>客群提升</td><td>定明回访</td><td>介绍达标客户的权益体系，邀请客户升级卡等级</td><td>高收益理财产品/卡权益体系</td></tr><tr><td>三方客群</td><td>客群提升</td><td>三方回流</td><td>分析目前市场行情，建议客户合理进行资产的分布，降低整体的 风脸</td><td>权益类基金</td></tr><tr><td>国有行净转出</td><td>客群提升</td><td>资金转出</td><td>了解客户转出的原因，用招行的理财产品收益优势授国转出的资</td><td>高收益理财产品</td></tr><tr><td>国有银行主账户</td><td>客群提升</td><td>服务邀约</td><td>金 综合介绍我行的财富管理优势，邀约客户体验。</td><td>高收益理财产品</td></tr><tr><td rowspan="5">苏醒 期</td><td>资产临界不达标</td><td>客群提升</td><td>定期回访</td><td>介绍达标客户的权益体系，激请客户达标享受更多的除</td><td>高收益理财产品/增值服务</td></tr><tr><td>高有效代发</td><td>代发留存</td><td>代发工资/奖金</td><td>洁合客户产品持仓及风险情况，制定周期性的定投计划或者财富</td><td>基金定投/摩揭智投/高收益理财</td></tr><tr><td>大额流入</td><td>大额留存</td><td>大额转入</td><td>产品的买入，实现资产的不断票积 了解客户后续的资全使用安排，用财富产品锁定资金</td><td>产品 高收益理财产品/流动性理财产品</td></tr><tr><td>大额流出</td><td>资金挽回</td><td>大额转出</td><td>了解客户转出的原因，给予合理化建议，邀约客户转回。</td><td>高收益理财产品/流动性理财产品</td></tr><tr><td>礼品型客户</td><td>粘度提升</td><td>权益活动</td><td>利用营销活动提升客户的信任度和粘度，先建立关系</td><td>活动</td></tr><tr><td>懵懂 期</td><td>活动型客户</td><td>粘度提升</td><td>综合活动</td><td>利用活动提升客户的信任度和粘度，逐渐挖掘客户潜力。</td><td>活动</td></tr></table></body></html>

# 长尾客群营销 （基于客户的潜力值及活跃度进行细分）

![](images/b9b62a913edc25c172eb5c69020206e950b27fa588f25fe2189a5f2741d01c91.jpg)

公司金融

# 贷款商机挖掘

建立分行级存量客户数据库一个数据库能装入分行XX×万零售客户一期建设若干授信敏感变量，包含个人反洗钱九要素，分行近一年12个月没有AUM数，四个季度结息数，以及是否为小微企业相关标识和信用卡持有情况

由于信用卡本身做了征信查询授权，就可以利用信用卡的贷后征信查询做信用模型，数据库的变量做白名单筛选。将总行产品预审模型到分行数据库跑数，生成最终准客户名单。

最终挑选出存量客户中符合贷款产品的准客户，交由三支队伍中的存量经营团队线下营销

分

C

分行存量零售客户xxx万

小微标识客户名单xx万

白名单

# 贷款商机挖掘

零售大表：客户姓名，年龄，收入，人生阶段，资产层级，职….

企业客户表：客户姓名，年龄，企业名称，行业经营范围，企业成立时间，持股比例，是否专精特新企业纳税评级

字段所属表：所属库名，表名，字段名称，中文名称，字段类型，字段描述，字段备注，脱敏类型，安全等级，允许空值，统计口径是否主键，是否码值

意愿表：号码，姓名，性别，年龄，是否纳税A评级，营销响应分

<html><body><table><tr><td>159XXXX</td><td>张飞</td><td>男</td><td>50</td><td>A</td><td>615</td></tr><tr><td>158XXXX</td><td>cy</td><td>男</td><td>38</td><td>A</td><td>625</td></tr><tr><td></td><td>……</td><td>……</td><td>……</td><td></td><td>……</td></tr></table></body></html>

XXX万零售客户（包括信用卡和非信用卡客群）

XX万小微客户

筛选营销响应分 $> 5 2 0$ 的客户

金融机构

# 金融机构大客户与交易相关性分析

# 场景：金融机构大客户与交易相关性

·市场上的波动会影响到金融机构大客户在我行的结算余额  
·对当前市场波动率进行判断，并基于结算余额与市场波动率的相关性进行分析和预警

100 （%）率 wwus

![](images/56aad6144ffdcc9a84d75a114b0ba2d4fa7804c0a3aa7816a8c912f4a0d2ac16.jpg)  
黄金期货主连

![](images/7e631f4ccb48257a64cac679e87135f5c778019a3ba7e68b0afcf7fd5e4f9e38.jpg)  
黑色系商品期货波动率  
沪镍期货主连

渠道运营

# 商圈生意机会地图

常住人群画像

区域消费等级

![](images/2651661b5159c0904f58941d920fbb9c50f6156bb65466a0505e7a9b51ba6f52.jpg)

# 商圈生意机会地图

![](images/e344912e2f9856c064fab2572d8c34fddd2988131513a5e56328dc5852750aa6.jpg)

基于GeoHash编码的区域，计算区域的竞争压力指数（网点密集度）

![](images/27b840c94044b9ec6f0fa957fbe9cb5fa241a23060710e71cbae83f3149b3611.jpg)

结合人口密度分布，计算区域网点的生意机会地图

风险管理

# 金融风控模型

# 场景：金融数据分析与风险控制

在信贷领域中存在信用卡违约和欺诈的风险，通过用户行为数据，分析申请借款用户的信用状况，来判断是否存在逾期。

通过分析交易时间、交易金额、收款方等多维度数据，我们还可以对信用卡会否被盗刷进行预测，防止信用卡被盗刷的风险

此外，通过预测模型，我们还可以分析出哪些因素容易导致违约，从而加强产品的设计

![](images/f10b39cf3008c759730302a61a0177da3736cdf5a9ee76fa3d94bbb8d486db33.jpg)

# 金融风控模型

![](images/9b4d049a74c2678e00812e83b2bc3626a3d3468ec99f337c85e7761c8957da18.jpg)

# 金融风控模型

# 评分卡模型:

·评分卡模型是常用的金融风控手段之一  
风控，就是风险控制，我们采取各种措施和方法，减少风险发生的  
可能性，或风险发生时造成的损失

·根据客户的各种属性和行为数据，利用信用评分模型，对客户的信用进行评分，从而决定是否给予授信，授信的额度和利率，减少在金融交易中存在的交易风险

·按照不同的业务阶段，可以划分为三种：

贷前：申请评分卡（Application score card），称为A卡贷中：行为评分卡（Behaviorscorecard），称为B卡贷后：催收评分卡（Collectionscorecard），称为C卡

Thinking：A卡B卡C卡的数据源有何区别？

1）外部征信数据是A卡中用户的主要数据  
2）对于复贷用户，已经有了历史平台表现，所以B卡通常不会再次查询用户的外部数据，而是利用历史平台表现 $\Rightarrow$ 节省成本  
3）c卡不会再次查询用户外部征信数据，主要利用历史贷款过程中，催收人员记录的用户表现作为主要数据

# 金融风控模型

# 评分卡模型:

·客户评分 $\mathbf { \tau } = \mathbf { \tau }$ 基准分 $^ +$ 年龄评分 $+$ 性别评分 $+$ 婚姻状况评分 $+$ 学历评分 $+$ 贷款申请次数

Thinking:某客户年龄为27岁，性别为男， 婚姻状况为已婚， 学历为本科， 贷款申请次数为1次， 那么他的评分 $= ?$

650 (基准分) $+ 8$ (年龄评分) $+ ~ 4 \AA$ （性别评分） $+ 8$ (婚姻 评分) $+ 1 2$ (学历评分) $^ +$ 13(贷款申请次数) $= 6 9 5$

Thinking：评分卡的最高分和最低分是多少？

最低分： $6 5 0 - 8 - 2 - 3 + 1 - 8 = 6 3 0$

最高分： $6 5 0 + 1 3 + 4 + 8 + 1 2 + 1 3 = 7 0 0$

<html><body><table><tr><td>变量名称</td><td>变量范围</td><td>得分</td></tr><tr><td>基准分</td><td></td><td>650</td></tr><tr><td rowspan="5">年龄</td><td>age<18</td><td>-8</td></tr><tr><td>18<=age<25</td><td>-2</td></tr><tr><td>25<=age<35</td><td>8</td></tr><tr><td>35<=age<55</td><td>13</td></tr><tr><td>55<=age</td><td>5</td></tr><tr><td rowspan="3">性别</td><td>男</td><td>4</td></tr><tr><td>女</td><td>2</td></tr><tr><td>未知</td><td>-2</td></tr><tr><td rowspan="3">婚姻状况</td><td>已婚</td><td>8</td></tr><tr><td>未婚</td><td>-2</td></tr><tr><td>未知</td><td>-3</td></tr><tr><td rowspan="3">学历</td><td>本科及以上</td><td>12</td></tr><tr><td>大专</td><td>8</td></tr><tr><td>其他</td><td>1</td></tr><tr><td rowspan="4">贷款申请次数 （二代征信）</td><td>>3次</td><td>-8</td></tr><tr><td>=3次</td><td>0</td></tr><tr><td>=2次</td><td>5</td></tr><tr><td><=1次</td><td>13</td></tr></table></body></html>

# Case: 基于评分卡的风控模型开发

Project：基于评分卡的风控模型开发

·数据集GiveMeSomeCredit，15万样本数据https://www.kaggle.com/c/GiveMeSomeCredit/data

－基本属性：包括了借款人当时的年龄

一偿债能力：包括了借款人的月收入、负债比率

－信用往来：两年内35-59天逾期次数、两年内60-89天逾期次数、两年内90天或高于90天逾期的次数

－财产状况：包括了开放式信贷和贷款数量、不动产贷款或额度数量。

一其他因素：包括了借款人的家属数量

一时间窗口：自变量的观察窗口为过去两年，因变量表现窗口为未来两年

<html><body><table><tr><td>字段</td><td>说明</td><td>类型</td></tr><tr><td>SeriousDlqin2yrs</td><td>90天以上逾期的人，未来2年违约</td><td>Y/N</td></tr><tr><td>Age</td><td>年龄</td><td>整数</td></tr><tr><td>RevolvingUtilizationOfUnsec uredLines</td><td>除房地产和汽车贷款等无分期付款债务 外，信用卡和个人信用额度的总余额除 以信贷限额</td><td>百分比</td></tr><tr><td>DebtRatio</td><td>债务比（每月偿还的债务，赡养费，生 活费除以每月的总收入)</td><td>百分比</td></tr><tr><td>Monthlylncome</td><td>每月收入</td><td>实数</td></tr><tr><td>NumberOfOpenCreditLines AndLoans</td><td>公开贷款(如汽车贷款或抵押贷款)和信 用额度(如信用卡)的数量</td><td>整数</td></tr><tr><td>NumberRealEstateLoansOrL ines</td><td>抵押贷款和房地产贷款的额度（包括房 屋净值信贷)</td><td>整数</td></tr><tr><td>NumberOfTime30- 59DaysPastDueNotWorse</td><td>借款人逾期30-59天的次数，但在过去两 年没有更糟</td><td>整数</td></tr><tr><td>NumberOfTime60- 89DaysPastDueNotWorse</td><td>借款人逾期60-89天的次数，但在过去两 年没有更糟</td><td>整数</td></tr><tr><td>NumberOfTimes90DaysLate</td><td>借款人逾期90天（或以上）的次数</td><td>整数</td></tr><tr><td>NumberOfDependents</td><td>除自己(配偶、子女等)以外的家庭受养 人人数</td><td>整数</td></tr></table></body></html>

资金交易

# 外汇市场预测

场景：外汇市场预测

·对外汇市场进行预测，进行金融产品设计比如两个月美债和人民币倒挂激增，再看欧元，是否做个三角套汇（是否有套利空间，如果银行推广这个商品银行是有收益的，对客户也是有收益的）

# 1）波动规律分析法

通过外汇市场行情的波动进行分析，认为之前的行情变化规律和后市行情的变化规律有一定的参照性

# 2）基本面分析法

适合中长期行情，货币的强弱反映该国经济的好坏，尽管中间会有暂时性的波动，但从长期来看，它的价位会最终回归到与经济状况相匹配的位置上。

3）技术分析法

比如MACD、RSI、移动平均线等指标作为分析依据

![](images/1d2a070a0a506dae01bd614ce078ffcbf803cf285ac762f483ffebeceb3f1a96.jpg)

# 期货套利模型

# 场景：期货套利模型

·影响某个品种的涨跌因素非常多（自身基本面、宏观经济、原材料价格等）  
·如果只做单边交易 $\Rightarrow$ 遇到突发事件，会造成剧烈波动，导致平仓  
·套利交易可以针对单品种跨期，跨品种交易  
两个合约的相关性极高，一多一空，可以对冲掉  
$90 \%$ 以上不确定因素 $\Rightarrow$ 只要核心逻辑正确的，大概  
率是赚钱的

Thinking: 空沪金&多伦敦金，在初期各投资50%在国内和国外，某一时期能稳定获利， 需要注意什么？

![](images/908cf09f197a29c8ab7fd2771af4000eb7048a18aa2a66623e72b1cbd14d2c24.jpg)

![](images/d311a2f42b92e7ad59c92db33d3659f013c1639a861ea6dfc2221e991be53bca.jpg)

数字财务

# 资金流入流出预测

# 场景：资金流入流出预测

· https://tianchi.aliyun.com/competition/entrance /231573/information

·数据集一共包括4张表：用户基本信息数据、用户申购赎回数据、收益率表和银行间拆借利率表

2.8万用户，284万行为数据，294天拆解利率，427天收益率

2013-07-01到2014-08-31，预测2014年9月的申购和赎回

1e8 1.00 0.75 IL. ld. 0.50   
reeeett 0.25 0.00 -0.25 -0.50 -0.75 -1.00 1 2 3 4 5 6 7 8 9 121314 15 1617181920 21 2223 24 2526 27 282930 31 date 1e8   
faaaett 105005 1 中 L山 -1.0 1 2 3 4 5 6 7 8 9 101112 1314 151617181920 21 22 23 24 25262728293031 date

# 财务数据可视化报表

# 场景：财务数据可视化报表

数据提取 数据分析 N> BI看板 二 运营建议

![](images/2bf9d50ae0ae514acafa629fccb7a059eaa5a3d7b32a584f78bb3d88a968fe0e.jpg)  
财务数据统计表

![](images/48f0731f47ef05a15693a5cc809ae0c956b73b1848e9bcdab31f5c6937b12bf1.jpg)

# 银行数智化面临的挑战

# 反欺诈

# 授信

# 运营

营销：个人或团体的羊毛甚至职业化羊毛党

申请：从个人/企业主体，转变为黑产主体

交易：从一方欺诈演变为更为隐蔽的三方欺诈

$$
\begin{array} { l } { 1 } \\ { 1 \qquad 1 \qquad } \\ { 1 \qquad \quad 1 } \\ { 1 \qquad \quad -- \qquad - -- \qquad -- \qquad 1 } \end{array}
$$

贷前信审：难以挖掘边界客户不利于精准审核/预授信/授信贷中风控：处理更多数据维度时难以做到实时化的再审核与放款

贷后管理：人工检测难以完成大批量、复杂行为数据下的风险状态评估

操作风险：人员操作、制度漏洞、监管缺失等造成的操作风险，迫切需要从运营、数据安全等层面加强对风险管控

流动性风险：银行产品竞争日趋激烈，风险的实时识别、资金流入流出的预测成为新挑战制造行业应用场景

# 螺栓扭矩曲线识别与缺陷检测

# ·业务场景：

螺栓是否拧紧对于汽车安全至关重要

现在的方法：技术人员只检测最终点是否在某个范围之内

# 可能的问题：

实际上，螺栓需要经过一个平台期，再最终达到规定的范围窗口内，安全质量会更高。否则只检测最终点，而没有达到平台期，可能多年之后会有安全隐患

![](images/ea5a51906de4f12db0d039ce47b8f75efedf66747eb9e0474d0d81ba57cf4ca2.jpg)

# 螺栓扭矩曲线识别与缺陷检测

·提出的数据分析解决方案：  
对完整的扭矩曲线进行分析，检测：  
1）是否存在平台期，以及平台期的长度  
2）是否在平台期之前，存在曲线抖动，计算抖动的次数(扭矩爬坡的抖动情况也是螺栓拧紧质量的重要特征)  
通过数据分析可以提取螺栓扭矩中的重要特征，从而对原  
有的螺栓拧紧标准进行更新 (之前只对最终点设立标准)

![](images/5a4923fcfcd7174302b99d9f49077c644395fa97ed82a327c1567027f6f209f1.jpg)

# 车身表面缺陷检测

#

![](images/ee576fc23e91ae20c5b6b8e49423790803085aaf4fe11e465544d0354d1cd333.jpg)

# 车身表面缺陷检测

![](images/621bed0c9a098e2d731852554f01597f3b2225f7b83da897fe78e5c15557bc7b.jpg)  
机器视觉算法

![](images/9e3259c1edaa2adf2d5a203bd95c78c5267734c519f04d1cd0b5ef6227286744.jpg)  
神经网络算法

快消行业应用场景

# 什么时候有个精准的预估？？？

![](images/7482b5687248f20811df374305e2ff8b597f1012f266d24149db9833616c2ef0.jpg)  
业务对于未来门店订货的期望

# AI应用场景思考

在日常工作中，您认为有哪些分析式AI与生成式AI的应用场景

客户流失分析与预警  
因客定价  
长尾客群营销  
贷款商机挖掘  
商圈生意机会地图  
基于评分卡的风控模型开发  
期货套利模型  
资金流入流出预测  
对公授信客户逾期分析  
百万客群经营  
反洗钱  
贷款集中度分析  
手机银行贷款页面优化  
贷款质量迁徙率与客户标签分析  
专精特新客群营销  
公司/机构财报分析  
营业厅智能推荐  
缺陷检测  
供应链补货预测

AI大赛：二手车价格预测（进阶）

# Project: 二手车交易价格预测

<html><body><table><tr><td colspan="4"></td></tr><tr><td colspan="2"></td><td>SaleID 交易ID，唯一编码</td></tr><tr><td colspan="2">·数据集：</td><td>name 汽车交易名称，已脱敏</td></tr><tr><td colspan="2">regDate</td><td>汽车注册日期，例如20160101，2016年01月01日</td></tr><tr><td colspan="2">used_car_train_20200313.csv</td><td>车型编码，已脱敏</td></tr><tr><td colspan="2">model brand</td><td>汽车品牌，已脱敏</td></tr><tr><td colspan="2">used_car_testB_20200313.csv bodyType</td><td>车身类型：华：轿车：0门汽：51商务车：2搅军车</td></tr><tr><td colspan="2">数据来自某交易平台的二手车交易记录</td><td>燃油类型：汽油：0，柴油：1，液化石油气：2，天然气： fuelType</td></tr><tr><td colspan="2">https://tianchi.aliyun.com/competition/</td><td>3，混合动力：4，其他：5，电动：6 gearbox 变速箱：手动：0，自动：1</td></tr><tr><td colspan="2">ntrance/231784/introduction</td><td>发动机功率：范围［0,600]</td></tr><tr><td colspan="2">power kilometer</td><td>汽车已行驶公里，单位万km</td></tr><tr><td colspan="2">ToDo：给你一辆车的各个属性（除了price字 notRepairedDamage regionCode</td><td>汽车有尚未修复的损坏：是：0，否：1</td></tr><tr><td colspan="2">段），预测它的价格</td><td></td></tr><tr><td colspan="2"></td><td>地区编码，已脱敏</td></tr><tr><td colspan="2">seller</td><td>销售方：个体：0，非个体：1</td></tr><tr><td colspan="2">offerType</td><td>报价类型：提供：0，请求：1</td></tr><tr><td colspan="2">creatDate</td><td>汽车上线时间，即开始售卖时间</td></tr><tr><td colspan="2">price v系列特征</td><td>二手车交易价格 (预测目标)</td></tr></table></body></html>

# Project: 二手车交易价格预测

：评价标准MAE(Mean Absolute Error):

若真实值为 $y = ( y _ { 1 } , y _ { 2 } , \cdots , y _ { n } )$ ，模型的预测值为 $\hat { y } = ( \hat { y } _ { 1 } , \hat { y } _ { 2 } , \dots , \hat { y } _ { n } )$ ，那么该模型的MAE计算公式为

$$
M A E = \frac { \sum _ { i = 1 } ^ { n } | y _ { i } - \hat { y } _ { i } | } { n } .
$$

例如，真实值 $y = ( 1 5 , 2 0 , 1 2 )$ ，预测值 $\hat { y } = ( 1 7 , 2 4 , 9 )$ ，那么这个预测结果的MAE为

$$
M A E = { \frac { | 1 5 - 1 7 | + | 2 0 - 2 4 | + | 1 2 - 9 | } { 3 } } = 3 .
$$

MAE是L1IoSS，MAE越小模型越准确

·提交结果，与sample_submit.csv中的格式一致

# Project: 二手车交易价格预测

# 祖传参数：

·Step1，数据加载  
原始数据是用空格分隔  
·Step2，数据探索  
数据整体情况  
查看缺失值，缺失值可视化  
查看label的分布（该项目中price为label）  
model $\mathbf { \Sigma } = \mathbf { \Sigma }$ xgb. XGBRegressor(n_estimator $= 2 0 0 0$ ， learning_rate=0.1,subsample=0.8， colsample_bytree=0.8,min_child_samples $\scriptstyle : = 3$ ，eval_metric $\mathbf { \Phi } = { \bf { \dot { \Phi } } }$ auc'  
reg_lambda ${ } _ { , = 0 }$ . 5,max depth $= 1 5$ ， tree method $\ P$ gpu hist' )

Step3，特征选择Step4，模型训练使用XGBoost，超参数设置·Step5，模型预测

# Project: 二手车交易价格预测

# Thinking: 如何进行特征工程？

1．数据预处理加载训练集和测试集数据，合并数据，便于统一进行特征工程。

2．特征工程

·创建时间特征（如车龄、注册季节等）。  
·创建车辆特征（如功率、品牌-车型组合、异常值处理等）。  
·创建统计特征（如品牌均价、品牌价格比等）。  
·编码分类特征（如频率编码、CatBoost分类特征标记）。

3．特征选择与数据准备

·删除无用特征：SaleID，name，offerType，seller（所有车offerType $\scriptstyle \cdot = 0$ ,seller只有1个为1，其他都为0)·确认所有分类特征被正确标记。  
·转换分类特征为 category 类型。

# Project: 二手车交易价格预测

def create_time_features(data): print("创建时间特征...") # 转换日期格式 data['regDate'] $\mathbf { \tau } = \mathbf { \tau }$ pd.to_datetime(data['regDate'], format='%Y%m%d', errors $\mathbf { \tau } = \mathbf { \dot { \tau } }$ coerce') data['creatDate'] $\mathbf { \sigma } = \mathbf { \sigma }$ pd.to_datetime(data['creatDate'], forma $\mathrel { \mathop = } \stackrel { \prime } { }$ %Y%m%d', errors $\ c = \ "$ coerce') # 处理无效日期 data.loc[data['regDate'J.isnul(), 'regDate'] $\mathbf { \sigma } = \mathbf { \sigma }$ pd.to_datetime('20160101', format='%Y%m%d') data.loc[data['creatDate'J.isnull(), 'creatDate'] $\mathbf { \sigma } = \mathbf { \sigma }$ pd.to_datetime('20160101', format='%Y%m%d') #车辆年龄（天数） data['vehicle_age_days'] $\mathbf { \tau } = \mathbf { \tau }$ (data['creatDate'] - data['regDate']).dt.days #修复异常值 data.loc[data['vehicle_age_days'] $< 0$ ,'vehicle_age_days'] = 0 #车辆年龄（年） data['vehicle_age_years'] $\mathbf { \sigma } = \mathbf { \sigma }$ data['vehicle_age_days'] / 365

# Project: 二手车交易价格预测

# 注册年份和月份   
data['reg_year'] $\mathbf { \tau } = \mathbf { \tau }$ data['regDate'].dt.year   
data['reg_month'] $\mathbf { \tau } = \mathbf { \tau }$ data['regDate'].dt.month   
data['reg_day'] $\mathbf { \tau } = \mathbf { \tau }$ data['regDate'].dt.day   
#创建年份和月份   
data['creat_year'] $\mathbf { \tau } = \mathbf { \tau }$ data['creatDate'].dt.year   
data['creat_month'] $\mathbf { \tau } = \mathbf { \tau }$ data['creatDate'].dt.month   
data['creat_day'] $\mathbf { \tau } = \mathbf { \tau }$ data['creatDate'].dt.day   
# 是否为新车（使用年限 ${ < } 1$ 年）   
data['is_new_car'] $\mathbf { \tau } = \mathbf { \tau }$ (data['vehicle_age_years']< 1).astype(int)   
# 季节特征   
data['reg_season'] $\mathbf { \tau } = \mathbf { \tau }$ data['reg_month'].apply(lambda x: $( \times \% 1 2 + 3 ) / / 3 )$ （22   
data['creat_season'] $\mathbf { \tau } = \mathbf { \tau }$ data['creat_month'].apply(lambda x: $( \times \% 1 2 + 3 ) / / 3 )$ （2号   
# 每年行驶的公里数   
data['km_per_year'] $\mathbf { \tau } = \mathbf { \tau }$ data['kilometer']/ (data['vehicle_age_years'] + 0.1)

# 车龄分段data['age_segment'] $\mathbf { \tau } = \mathbf { \tau }$ pd.cut(data['vehicle_age_years'],bins=[0, 1, 3, 5, 10, 100],la $b e l s = \tilde { \lfloor 0 - 1 \rfloor }$ 年','1-3年','3-5年','5-10年','10年以上])return data

# Project: 二手车交易价格预测

Thinking: 时间特征对建模的重要性？

·反映业务本质

时间特征往往与业务场景密切相关。例如在二手车价格预测中，车辆的使用年限（车龄）直接影响其残值，通常车龄越大，价格越低。

# ·揭示数据变化趋势

时间特征可以帮助模型捕捉数据随时间变化的趋势和周期性。例如某些车型在特定年份或季节更受欢迎，价格可能更高。

# 辅助异常检测

时间特征有助于发现数据中的异常点，比如注册日期晚于创建日期、车龄为负等，这些异常会影响模型效果。

# Project: 二手车交易价格预测

def create_car_features(data):

print("创建车辆特征...")

# 缺失值处理

numerical_features $\mathbf { \tau } = \mathbf { \tau }$ ['power','kiometer''v0',v_1','v2''3','4',5'v_6','v_7''v8',v9','10','11','12',v_13',14'] for feature in numerical_features:

# 标记缺失值   
data[f'{feature}_missing'] $=$ data[feature].isnull().astype(int) # 填充缺失值   
data[feature] $\mathbf { \sigma } = \mathbf { \sigma }$ data[feature].fillna(data[feature].median())

![](images/0706ec30cdbc6364b5a3e860ddb99ac17e5b309d1d46d5ce7b744cca499f333a.jpg)

对每个数值型特征，先生成一个“是否缺失”的二值特征，再用中位数填充缺失值。缺失本身可能蕴含信息（如某些车型的某项参数经常缺失），模型可以利用“缺失标记”捕捉这种隐含信号。

#将model转换为数值型特征   
data['model_num'] $\mathbf { \sigma } = \mathbf { \sigma }$ data['model'].astype('category').cat.codes   
# 品牌与车型组合   
data['brand_model'] $\mathbf { \Sigma } = \mathbf { \Sigma }$ data['brand'].astype(str) $+ _ { - } ^ { \prime \prime } +$ data['model'].astype(str)

品牌与车型组合，细化区分不同细分市场

# Project: 二手车交易价格预测

# 相对年份特征current_year $\mathbf { \sigma } = \mathbf { \sigma }$ datetime.datetime.now().yeardata['car_age_from_now'] $\mathbf { \tau } = \mathbf { \tau }$ current_year - data['reg_year']

# 处理异常值   
numerical_cols $\mathbf { \sigma } = \mathbf { \sigma }$ ['power','kilometer','v_0']   
for col in numerical_cols:   
Q1 = data[col].quantile(0.05)   
$\ Q 3 =$ data[col].quantile(0.95)   
$1 \mathsf { Q } \mathsf { R } = \mathsf { Q } \mathsf { 3 } - \mathsf { Q } \mathsf { 1 }$   
data[ $\mathfrak { f } \{ \mathsf { c o l } \} \_ { \mathsf { - } } \mathsf { o u t l i e r } ^ { \prime } ] = ( ( \mathsf { d a t a } \lbrack \mathsf { c o l } ] < ( \mathsf { O 1 } - \mathsf { 1 . 5 } ^ { \star } \mathsf { \Pi } \mathsf { I O R } ) ) \mid ( \mathsf { d a t a } \lbrack \mathsf { c o l } \rbrack > ( \mathsf { O 3 } + \mathsf { 1 . 5 } ^ { \star } \mathsf { \Pi } \mathsf { I O R } ) ) )$ .astype(int)   
data $^ -$

return data

对关键数值特征（如功率、公里数、排量）进行异常值检测，并生成异常标记，同时对异常值进行截断处理。异常值往往会影响模型的稳定性，通过标记和修正，既保留了异常信息，又减少了极端值对模型的干扰。

# Project: 二手车交易价格预测

def create_statistical_features(data, train_idx):print("创建统计特征...")# 仅使用训练集数据创建统计特征只用训练集数据做统计，避免把测试集泄漏到训练过train_data $\mathbf { \sigma } = \mathbf { \sigma }$ data.iloc[train_idx].reset_index(drop $\circleddash$ True)# 品牌级别统计brand_stats $\mathbf { \tau } = \mathbf { \tau }$ train_data.groupby('brand').agg(brand_price_mean $\ c =$ ('price','mean'), 对每个品牌，统计其在训练集中的平均价格、brand_price_median $\ c =$ ('price','median'), 中位数、标准差、样本数。brand_price_std $\ c =$ ('price','std'), 品牌均价/中位价：反映该品牌车辆的市场定位brand_price_count $\circleddash$ ('price','count') 和价值区间。).reset_index() 品牌价格标准差：反映该品牌车型价格的离散程度，间接体现品牌丰富度或车型跨度。# 合并统计特征品牌样本数：衡量品牌在数据集中的流行度。data $\mathbf { \tau } = \mathbf { \tau }$ data.merge(brand_stats, on $\ c = \ "$ brand', how $\mathbf { \bar { \rho } } = \mathbf { \rho }$ left')# 相对价格特征（相对于平均价格）data['brand_price_ratio'] $\mathbf { \sigma } = \mathbf { \sigma }$ data['brand_price_mean']/ data['brand_price_mean'].mean()return data

# Project: 二手车交易价格预测

def encode_categorical_features(data):print("编码分类特征...")# 目标编码的替代方案-频率编码categorical_cols $\mathbf { \sigma } = \mathbf { \sigma }$ ['model','brand','bodyType','fuelType', 'gearbox','notRepairedDamage']for col in categorical_cols:# 填充缺失值data[col] $=$ data[col].filina('未知') 将所有分类特征的缺失值统一填充为’未知’，避免 NaN 导致模型报错#频率编码freq_encoding $=$ data.groupby(col).size() / len(data)频率编码能反映某一类别的“流行度”或“稀有度”，data[f'{col}_freq'] $\mathbf { \sigma } = \mathbf { \sigma }$ data[col].map(freq_encoding)有助于模型捕捉类别分布信息。#将分类变量转换为CatBoost可以识别的格式 对高基数类别（如车型、品牌）尤其有效，能缓解 one-for col in categorical_cols: hot 编码维度爆炸的问题。data[col] $\mathbf { \tau } = \mathbf { \tau }$ data[col].astype('str')频率编码是目标编码的无监督替代方案，避免了数据泄return data, categorical_cols 漏风险。

# Project: 二手车交易价格预测

def feature_selection(data, categorical_cols): print("特征选择和最终数据准备...") # 删除不再需要的列，所有车offerType $_ { = 0 }$ ,seller只有1个为1，其他都为0 drop_cols $\mathbf { \sigma } = \mathbf { \sigma }$ ['regDate','creatDate','price','SalelD','name','offerType','seller','source'] data $\mathbf { \sigma } = \mathbf { \sigma }$ data.drop(drop_cols, axis $\ c =$ 1, errors $\ c = \ c ^ { \dagger }$ 'ignore')

# 确保所有分类特征都被正确标记   
if 'age_segment' not in categorical_cols and 'age_segment' in data.columns: categorical_cols.append('age_segment')   
if 'brand_model' not in categorical_cols and 'brand_model' in data.columns: categorical_cols.append('brand_model')

确保衍生出来的分段特征（如车龄分段、品牌-车型组合）被纳入分类特征列表。这些衍生特征往往有很强的业务意义，能提升模型对类别信息的理解。

#转换分类特征   
for col in categorical_cols: if col in data.columns: data[col] $=$ data[col].astype('category')   
return data, categorical_cols

category类型不仅节省内存，还能让CatBoost 等模型自动识别并高效处理类别特征。CatBoost能自动学习类别特征之间的高阶交互（如品牌$^ +$ 车型 $+$ 车龄分段），无需手动构造大量交叉特征。

![](images/f026ee908491346adf5f79c57d0150c11f8afc0f74e6fbb6762e349804433ac4.jpg)

# Project: 二手车交易价格预测

def train_catboost_model(X_train, X_val, y_train, y_val, cat_features): print("\n开始训练CatBoost模型...") # 创建数据池 train_pool $\mathbf { \sigma } = \mathbf { \sigma }$ Pool(X_train, y_train, cat_features $\ c =$ cat_features) val_pool $\mathbf { \sigma } = \mathbf { \sigma }$ Pool(X_val, y_val, cat_features $\ c =$ cat_features) # 设置模型参数 params $\begin{array} { r } { { \bf \Psi } = \left\{ \begin{array} { r l } \end{array} \right. } \end{array}$ （2号 'iterations': 3000, 'learning_rate': 0.03, 'depth': 6, 'I2_leaf_reg': 3, "bootstrap_type': 'Bayesian', 'random_seed': 42, 'od_type': 'Iter', 'od_wait': 100, 'verbose': 100,

'loss_function': 'MAE', 'eval_metric': 'MAE' 'task_type': 'CPU', 'thread_count': -1 } #创建模型 model $\mathbf { \tau } = \mathbf { \tau }$ CatBoostRegressor(\*\*params) # 训练模型 model.fit( train_pool, eval_set $\circeq$ val_pool, use_best_model $\mid =$ True, plot $\circleddash$ True model.save_model('processed_data/fe_catboost_model.cbm') return model

# Project: 二手车交易价格预测

![](images/fc5dd44533a6753c42e7ea65b172316d4f29e0f480e7bd4a1085556a3622f50d.jpg)  
开始训练CatBoost模型.

# Project: 二手车交易价格预测

![](images/8d735edc4917b6f1a7830cd1106f5367a05b849a5ee1e6f922f65309c42606b3.jpg)

# Summary 特征工程）

# 《二手车价格预测》项目中的特征工程：

# 1．时间特征处理

日期格式转换：将注册日期、创建日期转为 day_diff，或者年、月、日等衍生特征。  
衍生时间特征：如车龄（天/年）、注册/创建的年、月、日、季节、是否新车、每年行驶公里数、车龄分段等。  
异常值修正：如注册日期晚于创建日期的情况归为合理默认值。

# 2．车辆属性特征

缺失值处理与标记：对数值型特征填充中位数，并生成缺失标记特征。

特征交互与衍生：如品牌-车型组合、车辆绝对年龄等

异常值检测与修正：对功率、公里数、排量等做异常值标记和截断，减少极端值影响。

# Summary 特征工程）

# 3. 统计特征

品牌级别统计：基于训练集，统计每个品牌的均价、中位价、标准差、样本数。  
相对价格特征：如品牌均价与全体均价的比值，反映品牌市场定位。  
防止数据泄漏：统计特征只用训练集数据计算，保证评估公正性。

# 4．分类特征编码

缺失值统一填充： 所有分类特征缺失值填充为 ‘未知’。

频率编码：为每个类别特征生成其出现频率的数值特征，反映类别流行度。

类型转换：所有分类特征转为字符串或category 类型，便于CatBoost 原生处理。

5．特征选择与类型标准化

删除无用特征：如原始日期、ID、价格、冗余字段等。  
补充衍生类别特征：如车龄分段、品牌-车型组合等，纳入分类特征列表。  
类型标准化：所有分类特征转为category 类型，节省内存并提升模型兼容性。

# Summary 特征工程

# Thinking: 特征工程的价值？

特征工程决策模型上限，而模型（调参）只是把上限跑出来而已。

丰富的数据表达：通过多维度、多层次的特征衍生，极大提升了模型对业务本质的理解能力。  
高效的类别特征利用：充分发挥 CatBoost 对类别特征的原生支持，避免 one-hot 维度爆炸，提升模型性能。  
异常与缺失处理：通过缺失标记和异常值修正，提升模型鲁棒性和泛化能力。

Cursor进行特征工程，存在概率性的情况 $\Rightarrow$ 可能处理会有问题，比如：将 power+model进行数值相加，实际上没有物理含义，增加了噪音。没有将训练集和测试集合并，单独处理的特征工程，可能测试集的编码缺失的情况对kilometers的分箱可能是［0，5，10，20]，并不能反应整体的数据集的情况等$\Rightarrow$ 需要从业务角度，对特征工程进行验证

# 打卡：二手车价格预测

针对AI大赛：二手车价格预测，编写AI算法，进行预测，挑战分数<550 https://tianchi.aliyun.com/competition/entrance/231784/information

训练集： used_car_train_20200313.csv测试集： used_car_testB_20200421.csv选择适合的模型特征工程

时间特征处理车辆属性特征统计特征分类特征编码异常值处理

# Thank You Using data to solve problems