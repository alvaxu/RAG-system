 # 二手车价格预测特征工程与模型构建方案

## 一、特征工程

### 1. 特征选择与构造
- **基础特征**：
  - `brand`（品牌）、`model`（车型）、`bodyType`（车身类型）、`fuelType`（燃油类型）、`gearbox`（变速箱）、`regionCode`（地区编码）、`seller`、`offerType`。
- **时间特征**：
  - `regDate`（注册日期）、`creatDate`（创建日期）可拆分为年、月、日。
  - 构造`car_age`（车辆使用年限 = 创建年 - 注册年）。
- **数值特征**：
  - `power`（发动机功率）、`kilometer`（行驶公里数）、`notRepairedDamage`（未修复损伤，需处理缺失）。
- **类别特征编码**：
  - 对`brand`、`model`、`bodyType`、`fuelType`、`gearbox`、`regionCode`等类别特征采用LabelEncoder编码。
- **高频/低频类别处理**：
  - 对品牌、车型等类别特征，保留高频类别，低频类别归为“其他”。
- **组合特征**：
  - 品牌-车型组合、品牌-车身类型组合等，可用频数编码。

### 2. 匿名特征处理（v_0 ~ v_14）
- 对匿名特征`v_0`~`v_14`进行主成分分析（PCA），提取主要成分（如前5~8个主成分），以减少维度并保留主要信息。
- 主成分可作为新的特征加入模型。

### 3. 异常值处理
- **价格异常值**：
  - 去除价格极低（如<100元）或极高（如>10万元）的样本。
- **功率、公里数异常值**：
  - 对`power`、`kilometer`等特征，去除分布两端极端值（如用分位数截断）。
- **缺失值处理**：
  - `notRepairedDamage`中的“-”替换为NaN，缺失值用众数或新类别填充。
  - 其他缺失字段（如`bodyType`、`fuelType`、`gearbox`、`model`）用众数或新类别填充。

### 4. 特征归一化/标准化
- 对数值型特征（如`power`、`kilometer`、PCA主成分）可采用标准化（StandardScaler）或归一化（MinMaxScaler），提升模型效果。

---

## 二、模型构建

### 1. XGBoost模型选择
- 采用XGBoost回归模型（XGBRegressor），对类别特征和缺失值有较好兼容性，适合大规模结构化数据。
- 支持特征重要性分析，便于后续特征优化。

### 2. 训练与验证
- 划分训练集和验证集（如8:2），采用K折交叉验证提升模型泛化能力。
- 评价指标建议采用MAE（平均绝对误差）和RMSE（均方根误差）。

### 3. 超参数调优
- 可通过网格搜索（GridSearchCV）或贝叶斯优化等方法调优XGBoost参数（如max_depth、learning_rate、n_estimators、subsample等）。

### 4. 特征重要性分析
- 利用XGBoost自带的特征重要性分析，结合SHAP值进一步解释模型。
- 根据重要性结果，优化特征集。

---

## 三、整体流程示意

1. 数据清洗与特征工程：
   - 缺失值、异常值处理
   - 特征构造与编码
   - 匿名特征PCA降维
2. 特征归一化/标准化
3. 划分训练集/验证集
4. XGBoost建模与调参
5. 评估与特征重要性分析
6. 结果输出与模型优化

---

本方案充分利用了原始数据的多种特征，合理处理异常与缺失，结合PCA和XGBoost模型，能够有效提升二手车价格预测的准确性和模型可解释性。
