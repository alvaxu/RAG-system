## 代码说明
这段代码实现了一个完整的异常检测流程，从数据生成、可视化到模型构建和结果分析。以下是详细的执行过程和各部分功能解释：

### 1. 数据生成（已提供）
首先通过`make_blobs`生成了300个样本点，分为2个聚类，然后人为将最后10个点设置为离群点（特征值+5），并保存到Excel文件中。

### 2. 数据读取与可视化
代码读取Excel数据后，进行了多步可视化：
- 原始数据散点图：展示x1和x2的分布关系
- 直方图：分别展示x1和x2的数值分布
- 高斯分布曲线：基于数据均值和标准差构建理论正态分布曲线

### 3. 异常检测模型
使用`EllipticEnvelope`（椭圆包络模型）进行异常检测：
- `contamination=0.05`：设定异常点比例约为5%（可调整）
- 模型训练后预测出异常点（标记为-1）和正常点（标记为1）
- 最后将检测结果可视化，用红色星号标记异常点


### 代码特点与优化说明
1. 增加了循环测试不同`contamination`值（0.03、0.05、0.1），方便观察阈值对结果的影响
2. 自动根据数据范围生成高斯分布曲线的x轴范围，更贴合实际数据
3. 规范了图片保存和关闭操作，避免内存占用
4. 增加了详细的打印信息，方便跟踪程序执行过程

### 关键参数说明
- `contamination`：控制异常检测的灵敏度，值越大，被判定为异常点的比例可能越高
  - 较小值（如0.03）：检测标准严格，只有明显异常的点才会被识别
  - 较大值（如0.1）：检测标准宽松，更多点会被判定为异常

运行代码后，会生成多个图片文件，展示不同阈值下的异常检测效果，你可以根据实际需求选择最合适的阈值。

## 原理
代码中使用 `EllipticEnvelope`（椭圆包络模型）检测离群点的原理基于**统计概率**和**数据分布特性**，核心思想是：**正常数据会围绕某个中心形成特定的分布模式，而离群点会显著偏离这个模式**。以下是具体原理解析：


### 1. 前提假设：正常数据服从特定分布
椭圆包络模型假设**正常数据点会围绕一个中心形成“聚集分布”**（类似椭圆形状），而离群点则位于这个椭圆边界之外。  
对于二维数据（如代码中的 `x1` 和 `x2`），正常数据的分布可近似为一个椭圆区域：  
- 椭圆的中心由数据的均值（mean）决定（反映数据的集中位置）。  
- 椭圆的形状和大小由数据的协方差矩阵（covariance matrix）决定（反映数据在不同维度上的离散程度和相关性）。  


### 2. 核心计算：马氏距离（Mahalanobis Distance）
模型通过计算每个数据点到“正常分布中心”的**马氏距离**来判断是否为离群点：  
- 马氏距离是一种衡量数据点与分布中心偏离程度的指标，它考虑了数据各维度的标准差和相关性（比欧氏距离更合理）。  
- 距离越大，说明数据点偏离正常分布的程度越高，越可能是离群点。  


### 3. 阈值判定：通过 `contamination` 控制灵敏度
模型需要一个阈值来区分“正常点”和“离群点”，这个阈值通过参数 `contamination` 间接控制：  
- `contamination` 表示**预期的异常点比例**（例如 `contamination=0.05` 表示假设数据中约5%是离群点）。  
- 模型会根据这个比例，自动计算一个马氏距离的阈值：距离超过该阈值的点被标记为离群点（`-1`），否则为正常点（`1`）。  


### 4. 为什么适用于此场景？
代码中生成的数据具有明显的“正常集群+离群点”特征：  
- 大部分数据（290个点）形成两个密集的聚类（正常分布）。  
- 人为添加的10个离群点显著偏离了原始聚类（距离中心更远）。  
椭圆包络模型能有效捕捉这种“密集集群+稀疏离群”的模式，通过计算距离边界将离群点区分出来。  


### 总结
椭圆包络模型的本质是：**用一个“椭圆边界”圈住大多数正常数据，落在边界外的点被判定为离群点**。边界的大小由 `contamination` 控制——值越大，边界越“紧”，会判定更多点为异常；值越小，边界越“松”，只判定明显偏离的点为异常。这种方法适用于正常数据呈现聚集分布的场景。