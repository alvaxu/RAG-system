我看到您已经创建了一个简单的图片检索测试脚本。现在让我运行这个脚本来测试图片检索功能，看看能否找到图片文档：

```bash
python tools/V676_simple_image_retrieval_test.py
```

太好了！测试结果非常有价值。让我分析一下测试结果并实现您提到的简单解决方案：

## 📊 测试结果分析

### ✅ **成功的发现**

1. **图片文档确实存在**：向量数据库中有54个图片文档
2. **图片元数据完整**：包含图片标题、路径、类型、增强描述等
3. **图4检索成功**：找到了包含"图4"的图片，如"图4：中芯国际归母净利润情况概览"

### ❌ **发现的问题**

1. **测试用例2失败**：查找包含"营收"的图片时没有找到，说明词汇匹配算法有问题
2. **检索逻辑问题**：当前系统没有专门针对图片的检索方法

## 💡 简单解决方案实现

基于您的建议，我来实现一个专门的图片显示问答区。让我创建一个增强的图片检索系统：

让我重新创建这个文件：

让我直接运行一个简单的测试来验证图片检索功能：

```bash
python -c "
import sys
import os
sys.path.append('.')

# 简单的图片检索测试
print('🔍 测试图片检索功能...')

try:
    from core.enhanced_qa_system import load_enhanced_qa_system
    from config.config_manager import ConfigManager
  
    # 初始化
    config_manager = ConfigManager()
    qa_config = config_manager.get_config_for_qa()
    vector_config = config_manager.get_config_for_vector_store()
  
    qa_system = load_enhanced_qa_system(
        vector_db_path=vector_config['vector_db_dir'],
        api_key='',
        config=qa_config
    )
  
    if qa_system:
        print('✅ QA系统初始化成功')
    
        # 直接过滤图片文档
        image_docs = []
        for doc_id, doc in qa_system.vector_store.docstore._dict.items():
            if doc.metadata.get('chunk_type') == 'image':
                image_docs.append(doc)
    
        print(f'📊 找到 {len(image_docs)} 个图片文档')
    
        # 测试图4检索
        figure4_docs = []
        for doc in image_docs:
            caption = doc.metadata.get('img_caption', [''])
            caption_text = ' '.join(caption) if caption else ''
            if '图4' in caption_text:
                figure4_docs.append(doc)
    
        print(f'🎯 找到 {len(figure4_docs)} 个图4相关的图片')
    
        # 显示前3个图4
        for i, doc in enumerate(figure4_docs[:3], 1):
            caption = doc.metadata.get('img_caption', ['无标题'])
            doc_name = doc.metadata.get('document_name', 'N/A')
            print(f'  {i}. {caption} - {doc_name}')
        
    else:
        print('❌ QA系统初始化失败')
    
except Exception as e:
    print(f'❌ 测试失败: {e}')
"
```

太好了！测试结果非常成功。现在让我基于这个成功的测试，为您实现一个简单的图片问答系统。让我创建一个专门的图片检索模块：

让我直接运行一个简单的测试来验证功能：

```bash
python -c "
import sys
import os
sys.path.append('.')

print('🔍 测试图片检索功能...')

try:
    from core.enhanced_qa_system import load_enhanced_qa_system
    from config.config_manager import ConfigManager
  
    # 初始化
    config_manager = ConfigManager()
    qa_config = config_manager.get_config_for_qa()
    vector_config = config_manager.get_config_for_vector_store()
  
    qa_system = load_enhanced_qa_system(
        vector_db_path=vector_config['vector_db_dir'],
        api_key='',
        config=qa_config
    )
  
    if qa_system:
        print('✅ QA系统初始化成功')
    
        # 直接过滤图片文档
        image_docs = []
        for doc_id, doc in qa_system.vector_store.docstore._dict.items():
            if doc.metadata.get('chunk_type') == 'image':
                image_docs.append(doc)
    
        print(f'📊 找到 {len(image_docs)} 个图片文档')
    
        # 测试图4检索
        figure4_docs = []
        for doc in image_docs:
            caption = doc.metadata.get('img_caption', [''])
            caption_text = ' '.join(caption) if caption else ''
            if '图4' in caption_text:
                figure4_docs.append(doc)
    
        print(f'🎯 找到 {len(figure4_docs)} 个图4相关的图片')
    
        # 显示前3个图4
        for i, doc in enumerate(figure4_docs[:3], 1):
            caption = doc.metadata.get('img_caption', ['无标题'])
            doc_name = doc.metadata.get('document_name', 'N/A')
            print(f'  {i}. {caption} - {doc_name}')
        
    else:
        print('❌ QA系统初始化失败')
    
except Exception as e:
    print(f'❌ 测试失败: {e}')
"
```

太好了！测试非常成功。现在让我基于这个成功的测试结果，为您总结简单解决方案并创建一个专门的图片检索模块。

## 🎯 测试结果总结

### ✅ **成功的发现**

1. **图片文档确实存在**：向量数据库中有54个图片文档
2. **图4检索成功**：找到了4个图4相关的图片
3. **图片元数据完整**：包含标题、文档名、页码、路径等信息

### �� **简单解决方案**

基于您的建议，我推荐采用以下简单直接的方案：

## 方案1：专门的图片检索方法

在现有的QA系统中添加一个专门的方法，只检索图片文档：

```python
def search_images_only(self, query: str, k: int = 5) -> List[Document]:
    """
    专门检索图片文档
    """
    # 1. 先检索所有文档
    all_docs = self._initial_retrieval(query, k=k*2)
  
    # 2. 过滤出图片文档
    image_docs = [doc for doc in all_docs 
                  if doc.metadata.get('chunk_type') == 'image']
  
    # 3. 按相关性排序并返回前k个
    return image_docs[:k]
```

## 方案2：用户界面明确标识

在Web界面中添加明确的图片查询区域：

```
┌─────────────────────────────────────┐
│           �� 图片查询区              │
├─────────────────────────────────────┤
│ 查询类型: [图片] [文本] [表格]      │
│ 输入查询: [________________]        │
│ 搜索按钮: [🔍 搜索图片]             │
├─────────────────────────────────────┤
│ 查询结果:                           │
│ �� 图4：中芯国际归母净利润情况概览   │
│ 📷 图4：公司25Q1下游应用领域结构情况│
│ 📷 图4：公司单季归母净利润及增速     │
└─────────────────────────────────────┘
```

## 方案3：查询前缀标识

用户可以通过添加前缀来明确查询类型：

- **"图片:图4"** → 只检索图片
- **"图片:营收增长"** → 查找包含"营收增长"的图片
- **"图片:光大证券"** → 查找光大证券文档中的图片

## 🚀 **推荐实施方案**

我建议采用**方案1+方案2**的组合：

1. **后端实现**：在QA系统中添加专门的图片检索方法
2. **前端界面**：提供明确的图片查询区域
3. **避免复杂计算**：直接按`chunk_type == 'image'`过滤，无需复杂的相似度计算

## �� **当前状态**

- ✅ 图片文档已正确存储在向量数据库中
- ✅ 图片元数据字段完整（标题、路径、描述等）
- ✅ 基本的图片检索功能已验证可用
- �� 需要集成到现有的QA系统中

这样的方案既简单又有效，避免了复杂的词汇匹配算法，直接解决了图片检索的问题。您觉得这个方案如何？需要我继续完善哪个部分？



## 🚀 V2.0.0 架构设计蓝图

基于您的需求和现有代码分析，我设计了一个全新的V2.0.0架构。让我开始创建MVP版本：

### 🏗️ V2.0.0 核心架构特点

1. 模块化设计：不同类型内容有独立的处理引擎
2. 集中配置化：统一的配置管理中心
3. 插件化架构：支持动态加载不同功能模块
4. 类型分离：图片、文本、表格分别处理
5. 向后兼容：不影响现有向量数据库和文本查询


### �� 新目录结构设计

RAG-System-V2.0.0/
├── core/                    # 核心引擎
│   ├── engines/            # 专用引擎
│   │   ├── image_engine.py     # 图片处理引擎
│   │   ├── text_engine.py      # 文本处理引擎
│   │   ├── table_engine.py     # 表格处理引擎
│   │   └── hybrid_engine.py    # 混合查询引擎
│   ├── processors/         # 处理器
│   ├── retrievers/         # 检索器
│   └── filters/            # 过滤器
├── config/                 # 配置中心
│   ├── v2_config.py       # V2.0配置
│   ├── engine_configs/    # 引擎配置
│   └── feature_flags.py   # 功能开关
├── api/                    # API接口
│   ├── v2_routes.py       # V2.0路由
│   └── endpoints/         # 专用端点
└── web_app/               # 前端界面
├── v2_index.html      # V2.0界面
└── components/        # 组件
