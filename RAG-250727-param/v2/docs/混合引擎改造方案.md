å®Œå…¨æ­£ç¡®ï¼ç°åœ¨æˆ‘å®Œå…¨ç†è§£äº†è®¾è®¡ç†å¿µã€‚è®©æˆ‘é‡æ–°æ•´ç†ä¸€ä¸‹ï¼š

## ğŸ¯ **HybridEngine ç®€åŒ–æ”¹é€ æ–¹æ¡ˆï¼ˆæœ€ç»ˆç‰ˆï¼‰**

### **1. æ ¸å¿ƒè®¾è®¡ç†å¿µ**

- **æ‰€æœ‰å¼•æ“éƒ½ä½¿ç”¨æ–°Pipeline**ï¼šLLM + æº¯æºï¼Œæ²¡æœ‰æ—§pipeline
- **Reranking Service ç»Ÿä¸€æ€§**ï¼šæ··åˆreranking service å’Œå•å¼•æ“å„è‡ªçš„reranking service ç›®çš„å’Œè®¾è®¡ç†å¿µå®Œå…¨ä¸€æ ·
- **æµç¨‹ç»Ÿä¸€**ï¼šrecall â†’ reranking â†’ æ–°pipelineï¼ˆLLM + æº¯æºï¼‰

### **2. ä¿®æ­£åçš„è¯¦ç»†æµç¨‹å›¾**

```mermaid
flowchart TD
    A[æŸ¥è¯¢å¼€å§‹] --> B{æ£€æŸ¥æŸ¥è¯¢æ¨¡å¼}
    
    B -->|æŒ‡å®šç±»å‹| C[å•å¼•æ“æ¨¡å¼]
    B -->|æ™ºèƒ½å¼•æ“| D[æ™ºèƒ½åˆ¤æ–­æ¨¡å¼]
    B -->|æ··åˆå¼•æ“| E[æ··åˆå¼•æ“æ¨¡å¼]
    
    C --> C1[é€‰æ‹©æŒ‡å®šå¼•æ“]
    C1 --> C2[æ‰§è¡Œå¼•æ“recall]
    C2 --> C3[æ‰§è¡Œå¼•æ“reranking service]
    C3 --> C4[è°ƒç”¨æ–°Pipeline<br/>LLM + æº¯æº]
    
    D --> D1[åˆ†ææŸ¥è¯¢è¯­ä¹‰]
    D1 --> D2{èƒ½å¦ç¡®å®šç±»å‹?}
    D2 -->|èƒ½| F[é€‰æ‹©å•å¼•æ“]
    D2 -->|ä¸èƒ½| E
    
    F --> F1[æ‰§è¡Œå¼•æ“recall]
    F1 --> F2[æ‰§è¡Œå¼•æ“reranking service]
    F2 --> F3[è°ƒç”¨æ–°Pipeline<br/>LLM + æº¯æº]
    
    E --> E1[å¹¶è¡Œæ‰§è¡Œä¸‰å¼•æ“recall]
    E1 --> E2[èåˆrecallç»“æœ]
    E2 --> E3[è°ƒç”¨æ··åˆreranking service]
    E3 --> E4[è°ƒç”¨æ–°Pipeline<br/>LLM + æº¯æº]
    
    C4 --> G[æ„å»ºæœ€ç»ˆç»“æœ]
    F3 --> G
    E4 --> G
    
    G --> H[æŸ¥è¯¢ç»“æŸ]
```

### **3. ç®€åŒ–åçš„æ ¸å¿ƒåŠŸèƒ½**

#### **ä¿ç•™çš„æ ¸å¿ƒåŠŸèƒ½**
1. **æ™ºèƒ½è·¯ç”±**ï¼šæ ¹æ®æŸ¥è¯¢ç±»å‹é€‰æ‹©å•ä¸ªå¼•æ“æˆ–æ··åˆå¼•æ“
2. **æ™ºèƒ½åˆ¤æ–­**ï¼šé€šè¿‡è¯­ä¹‰åˆ†æé€‰æ‹©æœ€åˆé€‚çš„å•å¼•æ“
3. **ç»“æœèåˆ**ï¼šæ··åˆæ¨¡å¼ä¸‹èåˆä¸‰ä¸ªå¼•æ“çš„recallç»“æœ
4. **æ··åˆreranking**ï¼šä¸“é—¨çš„æ··åˆreranking service
5. **æ–°Pipelineé›†æˆ**ï¼šç»Ÿä¸€è°ƒç”¨æ–°pipelineï¼ˆLLM + æº¯æºï¼‰

#### **åˆ é™¤çš„å†—ä½™åŠŸèƒ½**
1. å¤æ‚çš„æ„å›¾åˆ†æå™¨
2. åºå¤§çš„ç»“æœèåˆå™¨
3. æ—§çš„ä¼˜åŒ–ç®¡é“
4. æ™ºèƒ½åå¤„ç†å¼•æ“
5. å¤æ‚çš„è´¨é‡è¯„ä¼°å’Œæ’åºç®—æ³•

### **4. ä»£ç ç»“æ„ç®€åŒ–**

```python
class HybridEngine:
    def process_query(self, query: str, **kwargs) -> QueryResult:
        # 1. è·¯ç”±åˆ¤æ–­
        # 2. è°ƒç”¨å¯¹åº”å¤„ç†æ–¹æ³•
        
    def _handle_single_engine_query(self, query: str, engine_type: str, **kwargs):
        # å•å¼•æ“ï¼šrecall â†’ reranking â†’ æ–°pipeline
        
    def _handle_smart_engine_query(self, query: str, **kwargs):
        # æ™ºèƒ½åˆ¤æ–­ï¼šè¯­ä¹‰åˆ†æ â†’ é€‰æ‹©å¼•æ“ â†’ å•å¼•æ“æµç¨‹
        
    def _handle_hybrid_engine_query(self, query: str, **kwargs):
        # æ··åˆå¼•æ“ï¼šä¸‰å¼•æ“recall â†’ èåˆ â†’ æ··åˆreranking â†’ æ–°pipeline
```

### **5. å…³é”®ä¼˜åŠ¿**

1. **ä»£ç é‡å¤§å¹…å‡å°‘**ï¼šä»2000+è¡Œå‡å°‘åˆ°300-500è¡Œ
2. **é€»è¾‘æ¸…æ™°**ï¼šä¸‰ç§æ¨¡å¼èŒè´£æ˜ç¡®ï¼Œæµç¨‹ç»Ÿä¸€
3. **ç»´æŠ¤ç®€å•**ï¼šæ²¡æœ‰å¤æ‚çš„èåˆé€»è¾‘ï¼Œæ˜“äºè°ƒè¯•
4. **æ€§èƒ½æå‡**ï¼šå‡å°‘ä¸å¿…è¦çš„å¤„ç†æ­¥éª¤
5. **æ‰©å±•æ€§å¥½**ï¼šæ–°å¢å¼•æ“ç±»å‹åªéœ€æ·»åŠ å¯¹åº”å¤„ç†æ–¹æ³•

è¿™æ ·çš„è®¾è®¡æ—¢ä¿æŒäº†åŠŸèƒ½çš„å®Œæ•´æ€§ï¼Œåˆå¤§å¤§ç®€åŒ–äº†ä»£ç ç»“æ„ï¼Œæ‚¨è§‰å¾—å¦‚ä½•ï¼Ÿ