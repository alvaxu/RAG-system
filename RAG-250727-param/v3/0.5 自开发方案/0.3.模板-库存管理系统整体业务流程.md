# 库存管理系统整体业务流程

# (如有可能，请用可视化方式展示，并添加简要文字介绍）

## 一、流程总览

整体流程围绕 “基础数据支撑→日常业务操作→异常预警处理→数据统计分析” 四大环节展开，覆盖管理员、仓管、店长三类核心角色，涉及 8 个系统模块协同，形成 “初始化 - 操作 - 监控 - 复盘” 的完整业务闭环，确保库存数据实时准确、业务操作合规可控。

## 二、分环节详细流程

### （一）环节 1：基础数据初始化（角色：系统管理员，核心模块：M01 基础设置）

1. **流程启动**：系统管理员通过账号密码登录系统，系统校验账号状态（是否禁用）与权限（是否为管理员角色），校验通过后进入系统首页；

1. **商品信息录入**：管理员点击 “基础设置” 模块（M01）→选择 “商品管理”→点击 “新增商品”，填写商品核心信息（商品名称、规格、SKU 编码、分类、单位），上传商品图片（可选），点击 “保存”；

- - 系统校验：自动检查 SKU 编码唯一性（若重复，提示 “SKU 已存在，请修改”）、必填字段完整性（若缺失，提示 “请补充商品名称 / 规格等必填信息”）；

- - 数据存储：校验通过后，商品信息写入product表，生成唯一product_id；

1. **供应商信息录入**：管理员在 M01 模块选择 “供应商管理”→“新增供应商”，填写供应商信息（名称、联系人、手机号、地址、合作状态），点击 “保存”；

- - 系统校验：检查手机号格式（若错误，提示 “请输入正确手机号”），合作状态默认设为 “正常”；

- - 数据存储：信息写入supplier表，生成唯一supplier_id；

1. **预警阈值配置**：管理员在 M01 模块选择 “库存阈值设置”→筛选目标商品（按商品名称 / 分类）→输入该商品的库存预警阈值（如 “食品类商品阈值 = 50 件，日用品类 = 30 件”），点击 “确认配置”；

- - 数据关联：阈值与商品product_id绑定，写入product_extend表；

1. **流程收尾**：所有数据录入完成后，系统弹出 “基础数据初始化成功” 提示，显示已录入商品数量（如 “共录入商品 20 个，供应商 5 家”），管理员可点击 “查看详情” 跳转至对应列表页核对数据，初始化流程结束。

### （二）环节 2：日常入库管理（角色：仓库管理员，核心模块：M02 入库管理、M06 库存管理、M07 日志管理）

1. **流程启动**：仓库管理员登录系统，系统校验其 “仓管” 角色权限，仅展示 “入库管理”“库存查询”“日志查询” 等有权限模块，管理员点击 “入库管理” 模块（M02）进入入库首页；

1. **入库方式选择**：

- - 方式 1（单商品入库）：点击 “新增入库单”→选择供应商（下拉框加载supplier表数据）→输入商品product_id或通过扫码枪扫描商品 SKU→系统自动带出商品名称、规格（从product表查询）→输入入库数量（如 “100 件”）、入库批次（可选，如 “20240520 批次”）、备注（如 “常规补货”）；

- - 方式 2（批量入库）：点击 “批量导入”→下载 Excel 模板（模板含 “product_id、商品名称、入库数量、供应商 id、批次” 等字段，带示例数据）→填写模板后上传→系统预览导入数据（显示 “待导入数据 10 条”）；

1. **数据校验与确认**：

- - 单商品校验：系统检查product_id是否存在（若不存在，提示 “商品不存在，请核对 ID”）、入库数量是否为正整数（若为负数 / 小数，提示 “数量需为正整数”）；

- - 批量校验：系统逐行检查模板数据，标记异常数据（如 “第 3 行：product_id 不存在；第 7 行：入库数量为负数”），提示 “共 10 条数据，8 条合法，2 条异常”，支持 “仅导入合法数据” 或 “修正后重新导入”；

- - 确认提交：管理员确认数据无误后，点击 “提交入库单”；

1. **入库单生成与库存更新**：

- - 订单生成：系统生成唯一入库单号（格式 “IN + 日期 + 随机数”，如 “IN20240520001”），入库单主信息（单号、供应商 id、操作人 id、入库时间、状态）写入in_order表，入库明细（单号、product_id、数量、批次）写入in_order_item表；

- - 库存联动：M02 模块调用 M06 库存管理模块的 “库存增加接口”，传入product_id与入库数量，M06 模块更新product_stock表中对应商品的stock_quantity（原库存 + 入库数量），记录last_update_time（当前时间）、last_update_user_id（仓管 id）；

1. **日志记录与结果反馈**：

- - 日志记录：M07 日志管理模块自动生成操作日志，写入operation_log表，日志内容含 “操作人：仓管 XXX，操作模块：M02，操作内容：创建入库单 IN20240520001，入库商品 10 件”，操作时间；

- - 结果反馈：系统跳转至入库单详情页，显示 “入库单创建成功，库存已更新”，展示入库单号、商品信息、入库数量、当前库存，支持 “打印入库单”“导出详情” 操作，入库流程结束。

### （三）环节 3：日常出库管理（角色：门店店长，核心模块：M03 出库管理、M06 库存管理、M04 预警管理、M07 日志管理）

1. **流程启动**：门店店长登录系统，系统校验 “店长” 角色权限，点击 “出库管理” 模块（M03）进入出库首页；

1. **出库信息填写**：点击 “新增出库单”→选择出库用途（下拉选项：“门店补货”“客户订单”“样品领用”）→输入商品product_id或扫码→系统调用 M06 模块接口查询当前库存（从product_stock表获取stock_quantity），并在页面显示 “当前库存：80 件”→输入出库数量（如 “20 件”），填写备注（如 “门店 A 补货”）；

1. **库存充足性校验**：点击 “下一步”，系统判断 “出库数量≤当前库存”：

- - 若不满足（如 “出库 20 件，当前库存 15 件”）：提示 “库存不足，当前库存 15 件，可出库最大数量 15 件”，禁止提交，店长可修改出库数量或取消操作；

- - 若满足：进入 “确认出库” 页面，展示出库单预览（用途、商品信息、数量、操作人、时间）；

1. **出库单生成与库存扣减**：

- - 订单生成：店长点击 “确认出库”，系统生成唯一出库单号（格式 “OUT + 日期 + 随机数”，如 “OUT20240520001”），主信息写入out_order表，明细写入out_order_item表；

- - 库存联动：M03 模块调用 M06 模块 “库存扣减接口”，传入product_id与出库数量，M06 模块更新product_stock表中stock_quantity（原库存 - 出库数量），记录更新时间与操作人；

1. **预警触发判断**：M06 模块更新库存后，自动查询该商品的预警阈值（从product_extend表获取），判断 “当前库存是否＜预警阈值”：

- - 若满足（如 “当前库存 60 件，阈值 50 件→不触发；当前库存 40 件，阈值 50 件→触发”）：M06 模块向 M04 预警管理模块推送预警信息（product_id、当前库存、阈值），M04 模块标记该商品为 “待预警” 状态；

- - 若不满足：无额外操作；

1. **日志记录与结果反馈**：

- - 日志记录：M07 模块生成日志，写入operation_log表，内容含 “操作人：店长 XXX，操作模块：M03，操作内容：创建出库单 OUT20240520001，出库商品 20 件”；

- - 结果反馈：系统显示 “出库成功，库存已更新”，展示出库单号、剩余库存（如 “剩余库存 60 件”），若触发预警，额外提示 “当前库存已低于预警阈值，已发起库存预警”，店长可点击 “查看预警” 跳转至 M04 模块，出库流程结束。

### （四）环节 4：库存预警与处理（角色：系统管理员 / 仓管，核心模块：M04 预警管理、M02 入库管理、M06 库存管理）

1. **流程启动**：

- - 自动启动：系统定时任务（每小时执行一次）触发 M04 模块，M04 调用 M06 模块 “库存查询接口”，批量获取所有商品的product_id、当前库存（stock_quantity）、预警阈值（关联product_extend表）；

- - 手动启动：管理员在 M04 模块点击 “手动触发预警”，执行上述相同查询操作；

1. **预警商品筛选**：M04 模块对比 “当前库存” 与 “预警阈值”，筛选出 “当前库存＜阈值” 的商品（如 “商品 A：库存 40＜阈值 50，商品 B：库存 20＜阈值 30”），生成预警商品列表；

1. **预警记录与通知**：

- - 记录生成：预警信息（product_id、商品名称、当前库存、阈值、预警时间、状态 “未处理”）写入warning_record表；

- - 通知推送：系统通过两种方式通知管理员 / 仓管：① 系统内弹窗（登录后可见 “您有 2 条库存预警待处理”）；② 邮件通知（发送至预设邮箱，内容含预警商品列表、补货建议 “建议补充商品 A 至 50 件以上”）；

1. **预警处理操作**：管理员登录系统，点击 M04 模块 “预警管理” 查看预警列表，选择目标预警商品：

- - 处理方式 1（发起补货）：点击 “去补货”→系统自动跳转至 M02 入库管理模块 “新增入库单” 页面，预填该商品product_id与建议入库数量（阈值 - 当前库存，如 “50-40=10 件”），管理员可修改数量后按入库流程操作；

- - 处理方式 2（忽略预警）：若因 “暂不补货（如商品即将下架）”，点击 “标记为已忽略”，填写忽略原因（如 “商品 A 下月下架，无需补货”），系统更新warning_record表中该记录状态为 “已忽略”；

1. **流程收尾**：所有预警处理完成后，管理员可在 M04 模块筛选 “已处理 / 已忽略” 预警记录，查看处理时间、操作人、原因，预警流程结束。

### （五）环节 5：数据统计与报表（角色：店长 / 管理员，核心模块：M08 报表中心、M02/M03/M06 模块）

1. **流程启动**：店长 / 管理员登录系统，点击 “报表中心” 模块（M08），进入报表生成页面；

1. **报表参数选择**：

- - 报表类型：下拉选择需生成的报表（可选 “库存变动报表”“入库汇总报表”“出库汇总报表”“预警统计报表”）；

- - 统计周期：选择时间范围（可选 “今日”“昨日”“本周”“上月”“自定义”，自定义需选择开始 / 结束日期）；

- - 筛选条件（可选）：库存变动报表可按 “商品分类” 筛选，入库 / 出库报表可按 “供应商 / 出库用途” 筛选；

1. **数据获取与报表生成**：点击 “生成报表”，M08 模块调用对应模块接口获取数据：

- - 库存变动报表：调用 M06 模块 “库存变动日志接口”，获取周期内商品库存变动记录（入库增加、出库减少、调整记录），计算每个商品的 “期初库存、期末库存、总变动量”；

- - 入库汇总报表：调用 M02 模块 “入库统计接口”，统计周期内各供应商入库金额 / 数量、各商品入库次数；

- - 数据处理：系统对获取的数据进行汇总计算（如 “本周入库商品总数量 1000 件，涉及 3 家供应商”），生成可视化图表（库存变动用折线图展示趋势，入库汇总用柱状图对比供应商数据）+ 明细表格；

1. **报表查看与导出**：

- - 在线查看：报表页面左侧展示图表，右侧展示明细表格（支持分页、列宽调整、关键词搜索）；

- - 导出操作：点击 “导出报表”，选择导出格式（Excel/PDF），系统按 “报表类型_周期_生成时间” 命名文件（如 “库存变动报表_20240501-20240531_202406011030.xlsx”），下载至本地；

1. **流程收尾**：用户可保存报表链接（支持分享给其他有权限用户），或打印报表（如 “打印入库汇总报表用于月度采购复盘”），报表流程结束。