# 4.0_deep_tuning_groupmean_best_combine_2.py 程序说明书

## 一、程序功能与流程概述
本程序基于分组均值法对余额宝每日申购与赎回总额进行预测，采用多周期因子组合，自动降级分组，输出9月预测结果及对比图。

## 二、特征工程
- **节假日特征**：显式定义2014年主要法定节假日、调休补班日，生成节假日DataFrame。
- **周期特征**：包括weekday、month_period（月内分段）、is_holiday、is_next_workday、is_month_end、is_quarter_end、is_festival_eve、holiday_len、is_long_holiday等。
- **特征输出**：所有特征工程结果均输出为csv，便于复用和分析。

## 三、分组均值模型选择与分组策略
- **模型类型**：分组均值法（GroupMean），适合强周期、强节假日扰动的金融时序。
- **分组因子**：weekday、month_period、is_holiday、is_next_workday、is_month_end。
- **降级策略**：优先用全部分组因子，若无匹配则依次去掉最后一个分组因子，最后用全局均值兜底。

## 四、训练与预测流程
- 训练区间：2014-03-01 ~ 2014-08-31
- 预测区间：2014-09-01 ~ 2014-09-30
- 训练流程：对训练区间按分组因子聚合，计算每组均值。
- 预测流程：对每一天，优先用全部分组因子匹配，若无则降级，最后用全局均值。
- 可视化：输出真实值与预测值对比图。

## 五、输入输出文件与格式
- 输入：
  - user_balance_table.csv（原始明细数据）
- 输出：
  - 4.0_deep_tuning_output/4.0_deep_tuning_holidays.csv（节假日表）
  - 4.0_deep_tuning_output/4.0_deep_tuning_daily_features.csv（特征工程结果）
  - 4.0_deep_tuning_output/4.0_deep_tuning_best_combine_predict.csv（9月预测结果，竞赛格式）
  - 4.0_deep_tuning_output/4.0_deep_tuning_best_combine_compare.png（对比图）

## 六、适用场景与局限性
- 适用于有明显周期性、节假日效应的金融时序预测。
- 对突发性、结构性变化（如政策、活动）拟合有限。
- 仅基于全局序列，无法建模用户级异质性。 